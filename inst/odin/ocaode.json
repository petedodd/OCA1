{"version":"1.5.11","config":{"base":"ocaode","include":null,"custom":null},"meta":{"internal":"internal","user":"user","state":"state","result":"dstatedt","output":"output","time":"t","initial_time":"initial_t"},"features":{"continuous":true,"discrete":false,"mixed":false,"has_array":true,"has_output":false,"has_user":true,"has_delay":false,"has_interpolate":true,"has_stochastic":false,"has_data":false,"has_compare":false,"has_include":false,"has_debug":false,"has_derivative":false,"initial_time_dependent":false},"data":{"elements":[{"name":"BF","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_BF","dim":[],"mult":[]},"stage":"user"},{"name":"BM","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_BM","dim":[],"mult":[]},"stage":"user"},{"name":"bzf","location":"transient","storage_type":"double","rank":0,"dimnames":null,"stage":"time"},{"name":"bzm","location":"transient","storage_type":"double","rank":0,"dimnames":null,"stage":"time"},{"name":"dim_BF","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_BM","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_N","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_N_1","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_N_12","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_N_2","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_N_3","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_native","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_omegaF","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_omegaM","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_popdatF","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_popdatF_1","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_popdatF_2","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_popdatM","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_popdatM_1","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_popdatM_2","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_popinitF","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_popinitF_1","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_popinitF_2","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_popinitM","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_popinitM_1","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_popinitM_2","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_r","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_ttp","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"null"},{"name":"initial_N","location":"internal","storage_type":"double","rank":3,"dimnames":{"length":"dim_N","dim":["dim_N_1","dim_N_2","dim_N_3"],"mult":["","dim_N_1","dim_N_12"]},"stage":"user"},{"name":"interpolate_bzf","location":"internal","storage_type":"interpolate_data","rank":0,"dimnames":null,"stage":"user"},{"name":"interpolate_bzm","location":"internal","storage_type":"interpolate_data","rank":0,"dimnames":null,"stage":"user"},{"name":"interpolate_omegaF","location":"internal","storage_type":"interpolate_data","rank":1,"dimnames":{"length":"dim_omegaF","dim":[],"mult":[]},"stage":"user"},{"name":"interpolate_omegaM","location":"internal","storage_type":"interpolate_data","rank":1,"dimnames":{"length":"dim_omegaM","dim":[],"mult":[]},"stage":"user"},{"name":"lttp","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"N","location":"variable","storage_type":"double","rank":3,"dimnames":{"length":"dim_N","dim":["dim_N_1","dim_N_2","dim_N_3"],"mult":["","dim_N_1","dim_N_12"]},"stage":"time"},{"name":"nage","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"native","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_native","dim":[],"mult":[]},"stage":"user"},{"name":"nnat","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"omegaF","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_omegaF","dim":[],"mult":[]},"stage":"time"},{"name":"omegaM","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_omegaM","dim":[],"mult":[]},"stage":"time"},{"name":"popdatF","location":"internal","storage_type":"double","rank":2,"dimnames":{"length":"dim_popdatF","dim":["dim_popdatF_1","dim_popdatF_2"],"mult":["","dim_popdatF_1"]},"stage":"user"},{"name":"popdatM","location":"internal","storage_type":"double","rank":2,"dimnames":{"length":"dim_popdatM","dim":["dim_popdatM_1","dim_popdatM_2"],"mult":["","dim_popdatM_1"]},"stage":"user"},{"name":"popinitF","location":"internal","storage_type":"double","rank":2,"dimnames":{"length":"dim_popinitF","dim":["dim_popinitF_1","dim_popinitF_2"],"mult":["","dim_popinitF_1"]},"stage":"user"},{"name":"popinitM","location":"internal","storage_type":"double","rank":2,"dimnames":{"length":"dim_popinitM","dim":["dim_popinitM_1","dim_popinitM_2"],"mult":["","dim_popinitM_1"]},"stage":"user"},{"name":"r","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_r","dim":[],"mult":[]},"stage":"user"},{"name":"ttp","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_ttp","dim":[],"mult":[]},"stage":"user"}],"variable":{"length":"dim_N","contents":[{"name":"N","offset":0,"initial":"initial_N"}]},"output":{"length":0,"contents":[]}},"equations":[{"name":"alloc_initial_N","type":"alloc","source":[66],"depends":{"functions":[],"variables":["dim_N"]},"lhs":"initial_N"},{"name":"alloc_native","type":"alloc","source":[65],"depends":{"functions":[],"variables":["dim_native"]},"lhs":"native"},{"name":"alloc_omegaF","type":"alloc","source":[62],"depends":{"functions":[],"variables":["dim_omegaF"]},"lhs":"omegaF"},{"name":"alloc_omegaM","type":"alloc","source":[63],"depends":{"functions":[],"variables":["dim_omegaM"]},"lhs":"omegaM"},{"name":"BF","type":"user","source":[27],"depends":{"functions":["length"],"variables":["dim_BF"]},"lhs":"BF","user":{"default":null,"dim":false,"min":null,"max":null}},{"name":"BM","type":"user","source":[28],"depends":{"functions":["length"],"variables":["dim_BM"]},"lhs":"BM","user":{"default":null,"dim":false,"min":null,"max":null}},{"name":"bzf","type":"interpolate","source":[33],"depends":{"functions":[],"variables":["t","interpolate_bzf"]},"lhs":"bzf","interpolate":"interpolate_bzf"},{"name":"bzm","type":"interpolate","source":[34],"depends":{"functions":[],"variables":["t","interpolate_bzm"]},"lhs":"bzm","interpolate":"interpolate_bzm"},{"name":"deriv_N","type":"expression_array","source":[47,48,50,51],"depends":{"functions":["-","*","["],"variables":["nnat","dim_N","bzm","native","k","omegaM","N","nage","r","i","bzf","omegaF"]},"lhs":"N","rhs":[{"index":[{"value":1,"is_range":false,"index":"i"},{"value":1,"is_range":false,"index":"j"},{"value":[":",1,"nnat"],"is_range":true,"index":"k"}],"value":["-",["*","bzm",["[","native","k"]],["*",["[","omegaM",1],["[","N",1,1,"k"]]]},{"index":[{"value":[":",2,"nage"],"is_range":true,"index":"i"},{"value":1,"is_range":false,"index":"j"},{"value":[":",1,"nnat"],"is_range":true,"index":"k"}],"value":["-",["*",["[","r",["-","i",1]],["[","N",["-","i",1],1,"k"]],["*",["[","omegaM","i"],["[","N","i",1,"k"]]]},{"index":[{"value":1,"is_range":false,"index":"i"},{"value":2,"is_range":false,"index":"j"},{"value":[":",1,"nnat"],"is_range":true,"index":"k"}],"value":["-",["*","bzf",["[","native","k"]],["*",["[","omegaF",1],["[","N",1,2,"k"]]]},{"index":[{"value":[":",2,"nage"],"is_range":true,"index":"i"},{"value":2,"is_range":false,"index":"j"},{"value":[":",1,"nnat"],"is_range":true,"index":"k"}],"value":["-",["*",["[","r",["-","i",1]],["[","N",["-","i",1],2,"k"]],["*",["[","omegaF","i"],["[","N","i",2,"k"]]]}]},{"name":"dim_BF","type":"expression_scalar","source":[60],"depends":{"functions":[],"variables":["lttp"]},"lhs":"dim_BF","rhs":{"value":"lttp"}},{"name":"dim_BM","type":"expression_scalar","source":[61],"depends":{"functions":[],"variables":["lttp"]},"lhs":"dim_BM","rhs":{"value":"lttp"}},{"name":"dim_N","type":"expression_scalar","source":[66],"depends":{"functions":[],"variables":["dim_N_1","dim_N_2","dim_N_3"]},"lhs":"dim_N","rhs":{"value":["*",["*","dim_N_1","dim_N_2"],"dim_N_3"]}},{"name":"dim_N_1","type":"expression_scalar","source":[66],"depends":{"functions":[],"variables":["nage","nnat"]},"lhs":"dim_N_1","rhs":{"value":"nage"}},{"name":"dim_N_12","type":"expression_scalar","source":[66],"depends":{"functions":[],"variables":["dim_N_1","dim_N_2"]},"lhs":"dim_N_12","rhs":{"value":["*","dim_N_1","dim_N_2"]}},{"name":"dim_N_2","type":"expression_scalar","source":[66],"depends":{"functions":[],"variables":["nage","nnat"]},"lhs":"dim_N_2","rhs":{"value":2}},{"name":"dim_N_3","type":"expression_scalar","source":[66],"depends":{"functions":[],"variables":["nage","nnat"]},"lhs":"dim_N_3","rhs":{"value":"nnat"}},{"name":"dim_native","type":"expression_scalar","source":[65],"depends":{"functions":[],"variables":["nnat"]},"lhs":"dim_native","rhs":{"value":"nnat"}},{"name":"dim_omegaF","type":"expression_scalar","source":[62],"depends":{"functions":[],"variables":["nage"]},"lhs":"dim_omegaF","rhs":{"value":"nage"}},{"name":"dim_omegaM","type":"expression_scalar","source":[63],"depends":{"functions":[],"variables":["nage"]},"lhs":"dim_omegaM","rhs":{"value":"nage"}},{"name":"dim_popdatF","type":"expression_scalar","source":[56],"depends":{"functions":[],"variables":["dim_popdatF_1","dim_popdatF_2"]},"lhs":"dim_popdatF","rhs":{"value":["*","dim_popdatF_1","dim_popdatF_2"]}},{"name":"dim_popdatF_1","type":"expression_scalar","source":[56],"depends":{"functions":[],"variables":["lttp","nage"]},"lhs":"dim_popdatF_1","rhs":{"value":"lttp"}},{"name":"dim_popdatF_2","type":"expression_scalar","source":[56],"depends":{"functions":[],"variables":["lttp","nage"]},"lhs":"dim_popdatF_2","rhs":{"value":"nage"}},{"name":"dim_popdatM","type":"expression_scalar","source":[57],"depends":{"functions":[],"variables":["dim_popdatM_1","dim_popdatM_2"]},"lhs":"dim_popdatM","rhs":{"value":["*","dim_popdatM_1","dim_popdatM_2"]}},{"name":"dim_popdatM_1","type":"expression_scalar","source":[57],"depends":{"functions":[],"variables":["lttp","nage"]},"lhs":"dim_popdatM_1","rhs":{"value":"lttp"}},{"name":"dim_popdatM_2","type":"expression_scalar","source":[57],"depends":{"functions":[],"variables":["lttp","nage"]},"lhs":"dim_popdatM_2","rhs":{"value":"nage"}},{"name":"dim_popinitF","type":"expression_scalar","source":[58],"depends":{"functions":[],"variables":["dim_popinitF_1","dim_popinitF_2"]},"lhs":"dim_popinitF","rhs":{"value":["*","dim_popinitF_1","dim_popinitF_2"]}},{"name":"dim_popinitF_1","type":"expression_scalar","source":[58],"depends":{"functions":[],"variables":["nage","nnat"]},"lhs":"dim_popinitF_1","rhs":{"value":"nage"}},{"name":"dim_popinitF_2","type":"expression_scalar","source":[58],"depends":{"functions":[],"variables":["nage","nnat"]},"lhs":"dim_popinitF_2","rhs":{"value":"nnat"}},{"name":"dim_popinitM","type":"expression_scalar","source":[59],"depends":{"functions":[],"variables":["dim_popinitM_1","dim_popinitM_2"]},"lhs":"dim_popinitM","rhs":{"value":["*","dim_popinitM_1","dim_popinitM_2"]}},{"name":"dim_popinitM_1","type":"expression_scalar","source":[59],"depends":{"functions":[],"variables":["nage","nnat"]},"lhs":"dim_popinitM_1","rhs":{"value":"nage"}},{"name":"dim_popinitM_2","type":"expression_scalar","source":[59],"depends":{"functions":[],"variables":["nage","nnat"]},"lhs":"dim_popinitM_2","rhs":{"value":"nnat"}},{"name":"dim_r","type":"expression_scalar","source":[67],"depends":{"functions":[],"variables":["nage"]},"lhs":"dim_r","rhs":{"value":"nage"}},{"name":"initial_N","type":"expression_array","source":[42,43],"depends":{"functions":["["],"variables":["nage","nnat","dim_N","popinitM","i","k","popinitF"]},"lhs":"initial_N","rhs":[{"index":[{"value":[":",1,"nage"],"is_range":true,"index":"i"},{"value":1,"is_range":false,"index":"j"},{"value":[":",1,"nnat"],"is_range":true,"index":"k"}],"value":["[","popinitM","i","k"]},{"index":[{"value":[":",1,"nage"],"is_range":true,"index":"i"},{"value":2,"is_range":false,"index":"j"},{"value":[":",1,"nnat"],"is_range":true,"index":"k"}],"value":["[","popinitF","i","k"]}]},{"name":"interpolate_bzf","type":"alloc_interpolate","source":[33],"depends":{"functions":[],"variables":["ttp","BF"]},"lhs":"interpolate_bzf","interpolate":{"t":"ttp","y":"BF","type":"linear","equation":"bzf"}},{"name":"interpolate_bzm","type":"alloc_interpolate","source":[34],"depends":{"functions":[],"variables":["ttp","BM"]},"lhs":"interpolate_bzm","interpolate":{"t":"ttp","y":"BM","type":"linear","equation":"bzm"}},{"name":"interpolate_omegaF","type":"alloc_interpolate","source":[31],"depends":{"functions":["length"],"variables":["dim_omegaF","ttp","popdatF","alloc_omegaF"]},"lhs":"interpolate_omegaF","interpolate":{"t":"ttp","y":"popdatF","type":"linear","equation":"omegaF"}},{"name":"interpolate_omegaM","type":"alloc_interpolate","source":[32],"depends":{"functions":["length"],"variables":["dim_omegaM","ttp","popdatM","alloc_omegaM"]},"lhs":"interpolate_omegaM","interpolate":{"t":"ttp","y":"popdatM","type":"linear","equation":"omegaM"}},{"name":"lttp","type":"expression_scalar","source":[55],"depends":{"functions":["length"],"variables":["dim_ttp"]},"lhs":"lttp","rhs":{"value":["length","ttp"]}},{"name":"nage","type":"user","source":[16],"depends":null,"lhs":"nage","user":{"default":null,"dim":false,"min":null,"max":null}},{"name":"native","type":"expression_array","source":[38,39],"depends":{"functions":[],"variables":["dim_native","nnat","alloc_native"]},"lhs":"native","rhs":[{"index":[{"value":1,"is_range":false,"index":"i"}],"value":1},{"index":[{"value":[":",2,"nnat"],"is_range":true,"index":"i"}],"value":0}]},{"name":"nnat","type":"user","source":[17],"depends":null,"lhs":"nnat","user":{"default":null,"dim":false,"min":null,"max":null}},{"name":"omegaF","type":"interpolate","source":[31],"depends":{"functions":[],"variables":["t","interpolate_omegaF"]},"lhs":"omegaF","interpolate":"interpolate_omegaF"},{"name":"omegaM","type":"interpolate","source":[32],"depends":{"functions":[],"variables":["t","interpolate_omegaM"]},"lhs":"omegaM","interpolate":"interpolate_omegaM"},{"name":"popdatF","type":"user","source":[21],"depends":{"functions":["dim"],"variables":["dim_popdatF"]},"lhs":"popdatF","user":{"default":null,"dim":false,"min":null,"max":null}},{"name":"popdatM","type":"user","source":[22],"depends":{"functions":["dim"],"variables":["dim_popdatM"]},"lhs":"popdatM","user":{"default":null,"dim":false,"min":null,"max":null}},{"name":"popinitF","type":"user","source":[25],"depends":{"functions":["dim"],"variables":["dim_popinitF"]},"lhs":"popinitF","user":{"default":null,"dim":false,"min":null,"max":null}},{"name":"popinitM","type":"user","source":[24],"depends":{"functions":["dim"],"variables":["dim_popinitM"]},"lhs":"popinitM","user":{"default":null,"dim":false,"min":null,"max":null}},{"name":"r","type":"user","source":[19],"depends":{"functions":["length"],"variables":["dim_r"]},"lhs":"r","user":{"default":null,"dim":false,"min":null,"max":null}},{"name":"ttp","type":"user","source":[29],"depends":null,"lhs":"ttp","user":{"default":null,"dim":true,"min":null,"max":null}}],"debug":[],"components":{"create":{"variables":[],"equations":[]},"user":{"variables":[],"equations":["nage","nnat","ttp","dim_N_1","dim_N_2","dim_N_3","dim_native","dim_omegaF","dim_omegaM","dim_popinitF_1","dim_popinitF_2","dim_popinitM_1","dim_popinitM_2","dim_r","alloc_native","alloc_omegaF","alloc_omegaM","dim_N","dim_N_12","dim_popinitF","dim_popinitM","lttp","r","alloc_initial_N","dim_BF","dim_BM","dim_popdatF_1","dim_popdatF_2","dim_popdatM_1","dim_popdatM_2","native","popinitF","popinitM","BF","BM","dim_popdatF","dim_popdatM","initial_N","interpolate_bzf","interpolate_bzm","popdatF","popdatM","interpolate_omegaF","interpolate_omegaM"]},"initial":{"variables":[],"equations":[]},"rhs":{"variables":["N"],"equations":["bzf","bzm","omegaF","omegaM","deriv_N"]},"update_stochastic":{"variables":[],"equations":[]},"output":{"variables":[],"equations":[]},"compare":{"variables":[],"equations":[]}},"user":[{"name":"BF","has_default":false},{"name":"BM","has_default":false},{"name":"nage","has_default":false},{"name":"nnat","has_default":false},{"name":"popdatF","has_default":false},{"name":"popdatM","has_default":false},{"name":"popinitF","has_default":false},{"name":"popinitM","has_default":false},{"name":"r","has_default":false},{"name":"ttp","has_default":false}],"interpolate":{"min":["ttp"],"max":["ttp"],"critical":[]},"source":["## ODEs for model","## ** suggested indices **","## demographic:","##  i = age        (compulsory)","##  j = sex        (compulsory)","##  k = nativity   (optional)","##  l = risk group (optional)","## TB:","##  i5 = post-TB   (compulsory)","##  i6 = strain    (optional)","##  i7 = protection from TPT + vaccination (optional)","##  (i8 = spare)","## optional => needs to work with dim = 1 so can be turned off","","## == inputs & interpolation","nage <- user()                            #number age cats","nnat <- user()                            #number of nativity cats","## nrisk <- user()                           #number of risk cats","r[] <- user()                             #aging rate","## demographic aging/mortality/net migration","popdatF[,] <- user()","popdatM[,] <- user()","## initial state","popinitM[,] <- user()","popinitF[,] <- user()","## birth rates","BF[] <- user()","BM[] <- user()","ttp[] <- user()","## interpolation","omegaF[] <- interpolate(ttp,popdatF,'linear')","omegaM[] <- interpolate(ttp,popdatM,'linear')","bzf <- interpolate(ttp,BF,'linear')","bzm <- interpolate(ttp,BM,'linear')","## useful qties","## firstage[1] <- 1","## firstage[2:nage] <- 0","native[1] <- 1","native[2:nnat] <- 0","","## == initial state","initial(N[1:nage,1,1:nnat]) <- popinitM[i,k]","initial(N[1:nage,2,1:nnat]) <- popinitF[i,k]","","## == dynamics","## male","deriv(N[1,1,1:nnat]) <- bzm * native[k] - omegaM[1] * N[1,1,k]","deriv(N[2:nage,1,1:nnat]) <- r[i-1] * N[i-1,1,k] - omegaM[i] * N[i,1,k]","## female","deriv(N[1,2,1:nnat]) <- bzf * native[k] - omegaF[1] * N[1,2,k]","deriv(N[2:nage,2,1:nnat]) <- r[i-1] * N[i-1,2,k] - omegaF[i] * N[i,2,k]","","## == dims","dim(ttp) <- user()                    #note need this before length() use","lttp <- length(ttp)","dim(popdatF) <- c(lttp,nage)","dim(popdatM) <- c(lttp,nage)","dim(popinitF) <- c(nage,nnat)","dim(popinitM) <- c(nage,nnat)","dim(BF) <- lttp","dim(BM) <- lttp","dim(omegaF) <- nage","dim(omegaM) <- nage","## dim(firstage) <- nage","dim(native) <- nnat","dim(N) <- c(nage,2,nnat)","dim(r) <- nage"]}
