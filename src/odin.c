// Automatically generated by odin 1.5.11 - do not edit
#include <float.h>
#include <R.h>
#include <Rmath.h>
#include <Rinternals.h>
#include <stdbool.h>
#include <R_ext/Rdynload.h>
#ifndef CINTERPOLTE_CINTERPOLATE_H_
#define CINTERPOLTE_CINTERPOLATE_H_

// Allow use from C++
#ifdef __cplusplus
extern "C" {
#endif

// There are only three functions in the interface; allocation,
// evaluation and freeing.

// Allocate an interpolation object.
//
//   type: The mode of interpolation. Must be one of "constant",
//       "linear" or "spline" (an R error is thrown if a different
//       value is given).
//
//   n: The number of `x` points to interpolate over
//
//   ny: the number of `y` points per `x` point.  This is 1 in the
//       case of zimple interpolation as used by Rs `interpolate()`
//
//   x: an array of `x` values of length `n`
//
//   y: an array of `ny` sets of `y` values.  This is in R's matrix
//       order (i.e., the first `n` values are the first series to
//       interpolate over).
//
//   fail_on_extrapolate: if true, when an extrapolation occurs throw
//       an error; if false return NA_REAL
//
//   auto_free: automatically clean up the interpolation object on
//       return to R. This uses `R_alloc` for allocations rather than
//       `Calloc` so freeing will always happen (even on error
//       elsewhere in the code). However, this prevents returning back
//       a pointer to R that will last longer than the call into C
//       code.
//
// The return value is an opaque pointer that can be passed through to
// `cinterpolate_eval` and `cinterpolate_free`
void *cinterpolate_alloc(const char *type, size_t n, size_t ny,
                         double *x, double *y, bool fail_on_extrapolate,
                         bool auto_free);

// Evaluate the interpolated function at a new `x` point.
//
//   x: A new, single, `x` point to interpolate `y` values to
//
//   obj: The interpolation object, as returned by `cinterpolate_alloc`
//
//   y: An array of length `ny` to store the interpolated values
//
// The return value is 0 if the interpolation is successful (with x
// lying within the range of values that the interpolation function
// supports), -1 otherwise
int cinterpolate_eval(double x, void *obj, double *y);

// Clean up all allocated memory
//
//   obj: The interpolation object, as returned by `cinterpolate_alloc`
void cinterpolate_free(void *obj);

#ifdef __cplusplus
}
#endif

#endif
typedef struct ocaode_internal {
  double *BF;
  double *birthrisk;
  double *BM;
  int dim_BF;
  int dim_birthrisk;
  int dim_BM;
  int dim_immigration_female;
  int dim_immigration_female_1;
  int dim_immigration_female_2;
  int dim_immigration_male;
  int dim_immigration_male_1;
  int dim_immigration_male_2;
  int dim_InF;
  int dim_InM;
  int dim_migrage;
  int dim_migrF;
  int dim_migrF_1;
  int dim_migrF_12;
  int dim_migrF_123;
  int dim_migrF_1234;
  int dim_migrF_12345;
  int dim_migrF_2;
  int dim_migrF_3;
  int dim_migrF_4;
  int dim_migrF_5;
  int dim_migrF_6;
  int dim_migrFagein;
  int dim_migrFagein_1;
  int dim_migrFagein_12;
  int dim_migrFagein_123;
  int dim_migrFagein_1234;
  int dim_migrFagein_12345;
  int dim_migrFagein_2;
  int dim_migrFagein_3;
  int dim_migrFagein_4;
  int dim_migrFagein_5;
  int dim_migrFagein_6;
  int dim_migrFageout;
  int dim_migrFageout_1;
  int dim_migrFageout_12;
  int dim_migrFageout_123;
  int dim_migrFageout_1234;
  int dim_migrFageout_12345;
  int dim_migrFageout_2;
  int dim_migrFageout_3;
  int dim_migrFageout_4;
  int dim_migrFageout_5;
  int dim_migrFageout_6;
  int dim_migrM;
  int dim_migrM_1;
  int dim_migrM_12;
  int dim_migrM_123;
  int dim_migrM_1234;
  int dim_migrM_12345;
  int dim_migrM_2;
  int dim_migrM_3;
  int dim_migrM_4;
  int dim_migrM_5;
  int dim_migrM_6;
  int dim_migrMagein;
  int dim_migrMagein_1;
  int dim_migrMagein_12;
  int dim_migrMagein_123;
  int dim_migrMagein_1234;
  int dim_migrMagein_12345;
  int dim_migrMagein_2;
  int dim_migrMagein_3;
  int dim_migrMagein_4;
  int dim_migrMagein_5;
  int dim_migrMagein_6;
  int dim_migrMageout;
  int dim_migrMageout_1;
  int dim_migrMageout_12;
  int dim_migrMageout_123;
  int dim_migrMageout_1234;
  int dim_migrMageout_12345;
  int dim_migrMageout_2;
  int dim_migrMageout_3;
  int dim_migrMageout_4;
  int dim_migrMageout_5;
  int dim_migrMageout_6;
  int dim_N;
  int dim_N_1;
  int dim_N_12;
  int dim_N_123;
  int dim_N_1234;
  int dim_N_12345;
  int dim_N_123456;
  int dim_N_2;
  int dim_N_3;
  int dim_N_4;
  int dim_N_5;
  int dim_N_6;
  int dim_N_7;
  int dim_native;
  int dim_omegaF;
  int dim_omegaM;
  int dim_Pmigr_nat;
  int dim_PmigrF_post;
  int dim_PmigrF_prot;
  int dim_PmigrF_risk;
  int dim_PmigrF_strain;
  int dim_PmigrM_post;
  int dim_PmigrM_prot;
  int dim_PmigrM_risk;
  int dim_PmigrM_strain;
  int dim_popdatF;
  int dim_popdatF_1;
  int dim_popdatF_2;
  int dim_popdatM;
  int dim_popdatM_1;
  int dim_popdatM_2;
  int dim_popinitF;
  int dim_popinitF_1;
  int dim_popinitF_12;
  int dim_popinitF_123;
  int dim_popinitF_1234;
  int dim_popinitF_12345;
  int dim_popinitF_2;
  int dim_popinitF_3;
  int dim_popinitF_4;
  int dim_popinitF_5;
  int dim_popinitF_6;
  int dim_popinitM;
  int dim_popinitM_1;
  int dim_popinitM_12;
  int dim_popinitM_123;
  int dim_popinitM_1234;
  int dim_popinitM_12345;
  int dim_popinitM_2;
  int dim_popinitM_3;
  int dim_popinitM_4;
  int dim_popinitM_5;
  int dim_popinitM_6;
  int dim_r;
  int dim_RiskChange;
  int dim_RiskChange_1;
  int dim_RiskChange_12;
  int dim_RiskChange_123;
  int dim_RiskChange_1234;
  int dim_RiskChange_12345;
  int dim_RiskChange_123456;
  int dim_RiskChange_2;
  int dim_RiskChange_3;
  int dim_RiskChange_4;
  int dim_RiskChange_5;
  int dim_RiskChange_6;
  int dim_RiskChange_7;
  int dim_RiskHazard;
  int dim_RiskHazard_1;
  int dim_RiskHazard_12;
  int dim_RiskHazard_2;
  int dim_RiskHazard_3;
  int dim_RiskHazardData;
  int dim_RiskHazardData_1;
  int dim_RiskHazardData_12;
  int dim_RiskHazardData_123;
  int dim_RiskHazardData_2;
  int dim_RiskHazardData_3;
  int dim_RiskHazardData_4;
  int dim_tbbottom;
  int dim_tbbottom_1;
  int dim_tbbottom_12;
  int dim_tbbottom_2;
  int dim_tbbottom_3;
  int dim_ttp;
  double *immigration_female;
  double *immigration_male;
  double *InF;
  double *initial_N;
  double *InM;
  void *interpolate_bzf;
  void *interpolate_bzm;
  void *interpolate_InF;
  void *interpolate_InM;
  void *interpolate_omegaF;
  void *interpolate_omegaM;
  void *interpolate_RiskHazard;
  int lttp;
  double *migrage;
  double *migrF;
  double *migrFagein;
  double *migrFageout;
  double *migrM;
  double *migrMagein;
  double *migrMageout;
  int nage;
  double *native;
  int nnat;
  int npost;
  int nprot;
  int nrisk;
  int nstrain;
  double *omegaF;
  double *omegaM;
  double *Pmigr_nat;
  double *PmigrF_post;
  double *PmigrF_prot;
  double *PmigrF_risk;
  double *PmigrF_strain;
  double *PmigrM_post;
  double *PmigrM_prot;
  double *PmigrM_risk;
  double *PmigrM_strain;
  double *popdatF;
  double *popdatM;
  double *popinitF;
  double *popinitM;
  double *r;
  double *RiskChange;
  double *RiskHazard;
  double *RiskHazardData;
  double *tbbottom;
  double *ttp;
} ocaode_internal;
ocaode_internal* ocaode_get_internal(SEXP internal_p, int closed_error);
static void ocaode_finalise(SEXP internal_p);
SEXP ocaode_create(SEXP user);
void ocaode_initmod_desolve(void(* odeparms) (int *, double *));
SEXP ocaode_contents(SEXP internal_p);
SEXP ocaode_set_user(SEXP internal_p, SEXP user);
SEXP ocaode_set_initial(SEXP internal_p, SEXP t_ptr, SEXP state_ptr, SEXP ocaode_use_dde_ptr);
SEXP ocaode_metadata(SEXP internal_p);
SEXP ocaode_initial_conditions(SEXP internal_p, SEXP t_ptr);
void ocaode_rhs(ocaode_internal* internal, double t, double * state, double * dstatedt, double * output);
void ocaode_rhs_dde(size_t neq, double t, double * state, double * dstatedt, void * internal);
void ocaode_rhs_desolve(int * neq, double * t, double * state, double * dstatedt, double * output, int * np);
SEXP ocaode_rhs_r(SEXP internal_p, SEXP t, SEXP state);
double user_get_scalar_double(SEXP user, const char *name,
                              double default_value, double min, double max);
int user_get_scalar_int(SEXP user, const char *name,
                        int default_value, double min, double max);
void user_check_values_double(double * value, size_t len,
                                  double min, double max, const char *name);
void user_check_values_int(int * value, size_t len,
                               double min, double max, const char *name);
void user_check_values(SEXP value, double min, double max,
                           const char *name);
SEXP user_list_element(SEXP list, const char *name);
void odin_set_dim(SEXP target, int rank, ...);
void* user_get_array_dim(SEXP user, bool is_integer, void * previous,
                         const char *name, int rank,
                         double min, double max, int *dest_dim);
void* user_get_array(SEXP user, bool is_integer, void * previous,
                     const char *name, double min, double max,
                     int rank, ...);
SEXP user_get_array_check(SEXP el, bool is_integer, const char *name,
                          double min, double max);
SEXP user_get_array_check_rank(SEXP user, const char *name, int rank,
                               bool required);
void interpolate_check_y(size_t nx, size_t ny, size_t i, const char *name_arg, const char *name_target);
double scalar_real(SEXP x, const char * name);
ocaode_internal* ocaode_get_internal(SEXP internal_p, int closed_error) {
  ocaode_internal *internal = NULL;
  if (TYPEOF(internal_p) != EXTPTRSXP) {
    Rf_error("Expected an external pointer");
  }
  internal = (ocaode_internal*) R_ExternalPtrAddr(internal_p);
  if (!internal && closed_error) {
    Rf_error("Pointer has been invalidated");
  }
  return internal;
}
void ocaode_finalise(SEXP internal_p) {
  ocaode_internal *internal = ocaode_get_internal(internal_p, 0);
  if (internal_p) {
    cinterpolate_free(internal->interpolate_bzf);
    cinterpolate_free(internal->interpolate_bzm);
    cinterpolate_free(internal->interpolate_InF);
    cinterpolate_free(internal->interpolate_InM);
    cinterpolate_free(internal->interpolate_omegaF);
    cinterpolate_free(internal->interpolate_omegaM);
    cinterpolate_free(internal->interpolate_RiskHazard);
    internal->interpolate_bzf = NULL;
    internal->interpolate_bzm = NULL;
    internal->interpolate_InF = NULL;
    internal->interpolate_InM = NULL;
    internal->interpolate_omegaF = NULL;
    internal->interpolate_omegaM = NULL;
    internal->interpolate_RiskHazard = NULL;
    R_Free(internal->BF);
    R_Free(internal->birthrisk);
    R_Free(internal->BM);
    R_Free(internal->immigration_female);
    R_Free(internal->immigration_male);
    R_Free(internal->InF);
    R_Free(internal->initial_N);
    R_Free(internal->InM);
    R_Free(internal->migrage);
    R_Free(internal->migrF);
    R_Free(internal->migrFagein);
    R_Free(internal->migrFageout);
    R_Free(internal->migrM);
    R_Free(internal->migrMagein);
    R_Free(internal->migrMageout);
    R_Free(internal->native);
    R_Free(internal->omegaF);
    R_Free(internal->omegaM);
    R_Free(internal->Pmigr_nat);
    R_Free(internal->PmigrF_post);
    R_Free(internal->PmigrF_prot);
    R_Free(internal->PmigrF_risk);
    R_Free(internal->PmigrF_strain);
    R_Free(internal->PmigrM_post);
    R_Free(internal->PmigrM_prot);
    R_Free(internal->PmigrM_risk);
    R_Free(internal->PmigrM_strain);
    R_Free(internal->popdatF);
    R_Free(internal->popdatM);
    R_Free(internal->popinitF);
    R_Free(internal->popinitM);
    R_Free(internal->r);
    R_Free(internal->RiskChange);
    R_Free(internal->RiskHazard);
    R_Free(internal->RiskHazardData);
    R_Free(internal->tbbottom);
    R_Free(internal->ttp);
    R_Free(internal);
    R_ClearExternalPtr(internal_p);
  }
}
SEXP ocaode_create(SEXP user) {
  ocaode_internal *internal = (ocaode_internal*) R_Calloc(1, ocaode_internal);
  internal->BF = NULL;
  internal->birthrisk = NULL;
  internal->BM = NULL;
  internal->immigration_female = NULL;
  internal->immigration_male = NULL;
  internal->InF = NULL;
  internal->initial_N = NULL;
  internal->InM = NULL;
  internal->interpolate_InF = NULL;
  internal->interpolate_InM = NULL;
  internal->interpolate_omegaF = NULL;
  internal->interpolate_omegaM = NULL;
  internal->interpolate_RiskHazard = NULL;
  internal->migrage = NULL;
  internal->migrF = NULL;
  internal->migrFagein = NULL;
  internal->migrFageout = NULL;
  internal->migrM = NULL;
  internal->migrMagein = NULL;
  internal->migrMageout = NULL;
  internal->native = NULL;
  internal->omegaF = NULL;
  internal->omegaM = NULL;
  internal->Pmigr_nat = NULL;
  internal->PmigrF_post = NULL;
  internal->PmigrF_prot = NULL;
  internal->PmigrF_risk = NULL;
  internal->PmigrF_strain = NULL;
  internal->PmigrM_post = NULL;
  internal->PmigrM_prot = NULL;
  internal->PmigrM_risk = NULL;
  internal->PmigrM_strain = NULL;
  internal->popdatF = NULL;
  internal->popdatM = NULL;
  internal->popinitF = NULL;
  internal->popinitM = NULL;
  internal->r = NULL;
  internal->RiskChange = NULL;
  internal->RiskHazard = NULL;
  internal->RiskHazardData = NULL;
  internal->tbbottom = NULL;
  internal->ttp = NULL;
  internal->BF = NULL;
  internal->birthrisk = NULL;
  internal->BM = NULL;
  internal->immigration_female = NULL;
  internal->immigration_male = NULL;
  internal->migrage = NULL;
  internal->nage = NA_INTEGER;
  internal->nnat = NA_INTEGER;
  internal->npost = NA_INTEGER;
  internal->nprot = NA_INTEGER;
  internal->nrisk = NA_INTEGER;
  internal->nstrain = NA_INTEGER;
  internal->PmigrF_post = NULL;
  internal->PmigrF_prot = NULL;
  internal->PmigrF_risk = NULL;
  internal->PmigrF_strain = NULL;
  internal->PmigrM_post = NULL;
  internal->PmigrM_prot = NULL;
  internal->PmigrM_risk = NULL;
  internal->PmigrM_strain = NULL;
  internal->popdatF = NULL;
  internal->popdatM = NULL;
  internal->popinitF = NULL;
  internal->popinitM = NULL;
  internal->r = NULL;
  internal->RiskHazardData = NULL;
  internal->ttp = NULL;
  SEXP ptr = PROTECT(R_MakeExternalPtr(internal, R_NilValue, R_NilValue));
  R_RegisterCFinalizer(ptr, ocaode_finalise);
  UNPROTECT(1);
  return ptr;
}
static ocaode_internal *ocaode_internal_ds;
void ocaode_initmod_desolve(void(* odeparms) (int *, double *)) {
  static DL_FUNC get_desolve_gparms = NULL;
  if (get_desolve_gparms == NULL) {
    get_desolve_gparms =
      R_GetCCallable("deSolve", "get_deSolve_gparms");
  }
  ocaode_internal_ds = ocaode_get_internal(get_desolve_gparms(), 1);
}
SEXP ocaode_contents(SEXP internal_p) {
  ocaode_internal *internal = ocaode_get_internal(internal_p, 1);
  SEXP contents = PROTECT(allocVector(VECSXP, 214));
  SEXP BF = PROTECT(allocVector(REALSXP, internal->dim_BF));
  memcpy(REAL(BF), internal->BF, internal->dim_BF * sizeof(double));
  SET_VECTOR_ELT(contents, 0, BF);
  SEXP birthrisk = PROTECT(allocVector(REALSXP, internal->dim_birthrisk));
  memcpy(REAL(birthrisk), internal->birthrisk, internal->dim_birthrisk * sizeof(double));
  SET_VECTOR_ELT(contents, 1, birthrisk);
  SEXP BM = PROTECT(allocVector(REALSXP, internal->dim_BM));
  memcpy(REAL(BM), internal->BM, internal->dim_BM * sizeof(double));
  SET_VECTOR_ELT(contents, 2, BM);
  SET_VECTOR_ELT(contents, 3, ScalarInteger(internal->dim_BF));
  SET_VECTOR_ELT(contents, 4, ScalarInteger(internal->dim_birthrisk));
  SET_VECTOR_ELT(contents, 5, ScalarInteger(internal->dim_BM));
  SET_VECTOR_ELT(contents, 6, ScalarInteger(internal->dim_immigration_female));
  SET_VECTOR_ELT(contents, 7, ScalarInteger(internal->dim_immigration_female_1));
  SET_VECTOR_ELT(contents, 8, ScalarInteger(internal->dim_immigration_female_2));
  SET_VECTOR_ELT(contents, 9, ScalarInteger(internal->dim_immigration_male));
  SET_VECTOR_ELT(contents, 10, ScalarInteger(internal->dim_immigration_male_1));
  SET_VECTOR_ELT(contents, 11, ScalarInteger(internal->dim_immigration_male_2));
  SET_VECTOR_ELT(contents, 12, ScalarInteger(internal->dim_InF));
  SET_VECTOR_ELT(contents, 13, ScalarInteger(internal->dim_InM));
  SET_VECTOR_ELT(contents, 14, ScalarInteger(internal->dim_migrage));
  SET_VECTOR_ELT(contents, 15, ScalarInteger(internal->dim_migrF));
  SET_VECTOR_ELT(contents, 16, ScalarInteger(internal->dim_migrF_1));
  SET_VECTOR_ELT(contents, 17, ScalarInteger(internal->dim_migrF_12));
  SET_VECTOR_ELT(contents, 18, ScalarInteger(internal->dim_migrF_123));
  SET_VECTOR_ELT(contents, 19, ScalarInteger(internal->dim_migrF_1234));
  SET_VECTOR_ELT(contents, 20, ScalarInteger(internal->dim_migrF_12345));
  SET_VECTOR_ELT(contents, 21, ScalarInteger(internal->dim_migrF_2));
  SET_VECTOR_ELT(contents, 22, ScalarInteger(internal->dim_migrF_3));
  SET_VECTOR_ELT(contents, 23, ScalarInteger(internal->dim_migrF_4));
  SET_VECTOR_ELT(contents, 24, ScalarInteger(internal->dim_migrF_5));
  SET_VECTOR_ELT(contents, 25, ScalarInteger(internal->dim_migrF_6));
  SET_VECTOR_ELT(contents, 26, ScalarInteger(internal->dim_migrFagein));
  SET_VECTOR_ELT(contents, 27, ScalarInteger(internal->dim_migrFagein_1));
  SET_VECTOR_ELT(contents, 28, ScalarInteger(internal->dim_migrFagein_12));
  SET_VECTOR_ELT(contents, 29, ScalarInteger(internal->dim_migrFagein_123));
  SET_VECTOR_ELT(contents, 30, ScalarInteger(internal->dim_migrFagein_1234));
  SET_VECTOR_ELT(contents, 31, ScalarInteger(internal->dim_migrFagein_12345));
  SET_VECTOR_ELT(contents, 32, ScalarInteger(internal->dim_migrFagein_2));
  SET_VECTOR_ELT(contents, 33, ScalarInteger(internal->dim_migrFagein_3));
  SET_VECTOR_ELT(contents, 34, ScalarInteger(internal->dim_migrFagein_4));
  SET_VECTOR_ELT(contents, 35, ScalarInteger(internal->dim_migrFagein_5));
  SET_VECTOR_ELT(contents, 36, ScalarInteger(internal->dim_migrFagein_6));
  SET_VECTOR_ELT(contents, 37, ScalarInteger(internal->dim_migrFageout));
  SET_VECTOR_ELT(contents, 38, ScalarInteger(internal->dim_migrFageout_1));
  SET_VECTOR_ELT(contents, 39, ScalarInteger(internal->dim_migrFageout_12));
  SET_VECTOR_ELT(contents, 40, ScalarInteger(internal->dim_migrFageout_123));
  SET_VECTOR_ELT(contents, 41, ScalarInteger(internal->dim_migrFageout_1234));
  SET_VECTOR_ELT(contents, 42, ScalarInteger(internal->dim_migrFageout_12345));
  SET_VECTOR_ELT(contents, 43, ScalarInteger(internal->dim_migrFageout_2));
  SET_VECTOR_ELT(contents, 44, ScalarInteger(internal->dim_migrFageout_3));
  SET_VECTOR_ELT(contents, 45, ScalarInteger(internal->dim_migrFageout_4));
  SET_VECTOR_ELT(contents, 46, ScalarInteger(internal->dim_migrFageout_5));
  SET_VECTOR_ELT(contents, 47, ScalarInteger(internal->dim_migrFageout_6));
  SET_VECTOR_ELT(contents, 48, ScalarInteger(internal->dim_migrM));
  SET_VECTOR_ELT(contents, 49, ScalarInteger(internal->dim_migrM_1));
  SET_VECTOR_ELT(contents, 50, ScalarInteger(internal->dim_migrM_12));
  SET_VECTOR_ELT(contents, 51, ScalarInteger(internal->dim_migrM_123));
  SET_VECTOR_ELT(contents, 52, ScalarInteger(internal->dim_migrM_1234));
  SET_VECTOR_ELT(contents, 53, ScalarInteger(internal->dim_migrM_12345));
  SET_VECTOR_ELT(contents, 54, ScalarInteger(internal->dim_migrM_2));
  SET_VECTOR_ELT(contents, 55, ScalarInteger(internal->dim_migrM_3));
  SET_VECTOR_ELT(contents, 56, ScalarInteger(internal->dim_migrM_4));
  SET_VECTOR_ELT(contents, 57, ScalarInteger(internal->dim_migrM_5));
  SET_VECTOR_ELT(contents, 58, ScalarInteger(internal->dim_migrM_6));
  SET_VECTOR_ELT(contents, 59, ScalarInteger(internal->dim_migrMagein));
  SET_VECTOR_ELT(contents, 60, ScalarInteger(internal->dim_migrMagein_1));
  SET_VECTOR_ELT(contents, 61, ScalarInteger(internal->dim_migrMagein_12));
  SET_VECTOR_ELT(contents, 62, ScalarInteger(internal->dim_migrMagein_123));
  SET_VECTOR_ELT(contents, 63, ScalarInteger(internal->dim_migrMagein_1234));
  SET_VECTOR_ELT(contents, 64, ScalarInteger(internal->dim_migrMagein_12345));
  SET_VECTOR_ELT(contents, 65, ScalarInteger(internal->dim_migrMagein_2));
  SET_VECTOR_ELT(contents, 66, ScalarInteger(internal->dim_migrMagein_3));
  SET_VECTOR_ELT(contents, 67, ScalarInteger(internal->dim_migrMagein_4));
  SET_VECTOR_ELT(contents, 68, ScalarInteger(internal->dim_migrMagein_5));
  SET_VECTOR_ELT(contents, 69, ScalarInteger(internal->dim_migrMagein_6));
  SET_VECTOR_ELT(contents, 70, ScalarInteger(internal->dim_migrMageout));
  SET_VECTOR_ELT(contents, 71, ScalarInteger(internal->dim_migrMageout_1));
  SET_VECTOR_ELT(contents, 72, ScalarInteger(internal->dim_migrMageout_12));
  SET_VECTOR_ELT(contents, 73, ScalarInteger(internal->dim_migrMageout_123));
  SET_VECTOR_ELT(contents, 74, ScalarInteger(internal->dim_migrMageout_1234));
  SET_VECTOR_ELT(contents, 75, ScalarInteger(internal->dim_migrMageout_12345));
  SET_VECTOR_ELT(contents, 76, ScalarInteger(internal->dim_migrMageout_2));
  SET_VECTOR_ELT(contents, 77, ScalarInteger(internal->dim_migrMageout_3));
  SET_VECTOR_ELT(contents, 78, ScalarInteger(internal->dim_migrMageout_4));
  SET_VECTOR_ELT(contents, 79, ScalarInteger(internal->dim_migrMageout_5));
  SET_VECTOR_ELT(contents, 80, ScalarInteger(internal->dim_migrMageout_6));
  SET_VECTOR_ELT(contents, 81, ScalarInteger(internal->dim_N));
  SET_VECTOR_ELT(contents, 82, ScalarInteger(internal->dim_N_1));
  SET_VECTOR_ELT(contents, 83, ScalarInteger(internal->dim_N_12));
  SET_VECTOR_ELT(contents, 84, ScalarInteger(internal->dim_N_123));
  SET_VECTOR_ELT(contents, 85, ScalarInteger(internal->dim_N_1234));
  SET_VECTOR_ELT(contents, 86, ScalarInteger(internal->dim_N_12345));
  SET_VECTOR_ELT(contents, 87, ScalarInteger(internal->dim_N_123456));
  SET_VECTOR_ELT(contents, 88, ScalarInteger(internal->dim_N_2));
  SET_VECTOR_ELT(contents, 89, ScalarInteger(internal->dim_N_3));
  SET_VECTOR_ELT(contents, 90, ScalarInteger(internal->dim_N_4));
  SET_VECTOR_ELT(contents, 91, ScalarInteger(internal->dim_N_5));
  SET_VECTOR_ELT(contents, 92, ScalarInteger(internal->dim_N_6));
  SET_VECTOR_ELT(contents, 93, ScalarInteger(internal->dim_N_7));
  SET_VECTOR_ELT(contents, 94, ScalarInteger(internal->dim_native));
  SET_VECTOR_ELT(contents, 95, ScalarInteger(internal->dim_omegaF));
  SET_VECTOR_ELT(contents, 96, ScalarInteger(internal->dim_omegaM));
  SET_VECTOR_ELT(contents, 97, ScalarInteger(internal->dim_Pmigr_nat));
  SET_VECTOR_ELT(contents, 98, ScalarInteger(internal->dim_PmigrF_post));
  SET_VECTOR_ELT(contents, 99, ScalarInteger(internal->dim_PmigrF_prot));
  SET_VECTOR_ELT(contents, 100, ScalarInteger(internal->dim_PmigrF_risk));
  SET_VECTOR_ELT(contents, 101, ScalarInteger(internal->dim_PmigrF_strain));
  SET_VECTOR_ELT(contents, 102, ScalarInteger(internal->dim_PmigrM_post));
  SET_VECTOR_ELT(contents, 103, ScalarInteger(internal->dim_PmigrM_prot));
  SET_VECTOR_ELT(contents, 104, ScalarInteger(internal->dim_PmigrM_risk));
  SET_VECTOR_ELT(contents, 105, ScalarInteger(internal->dim_PmigrM_strain));
  SET_VECTOR_ELT(contents, 106, ScalarInteger(internal->dim_popdatF));
  SET_VECTOR_ELT(contents, 107, ScalarInteger(internal->dim_popdatF_1));
  SET_VECTOR_ELT(contents, 108, ScalarInteger(internal->dim_popdatF_2));
  SET_VECTOR_ELT(contents, 109, ScalarInteger(internal->dim_popdatM));
  SET_VECTOR_ELT(contents, 110, ScalarInteger(internal->dim_popdatM_1));
  SET_VECTOR_ELT(contents, 111, ScalarInteger(internal->dim_popdatM_2));
  SET_VECTOR_ELT(contents, 112, ScalarInteger(internal->dim_popinitF));
  SET_VECTOR_ELT(contents, 113, ScalarInteger(internal->dim_popinitF_1));
  SET_VECTOR_ELT(contents, 114, ScalarInteger(internal->dim_popinitF_12));
  SET_VECTOR_ELT(contents, 115, ScalarInteger(internal->dim_popinitF_123));
  SET_VECTOR_ELT(contents, 116, ScalarInteger(internal->dim_popinitF_1234));
  SET_VECTOR_ELT(contents, 117, ScalarInteger(internal->dim_popinitF_12345));
  SET_VECTOR_ELT(contents, 118, ScalarInteger(internal->dim_popinitF_2));
  SET_VECTOR_ELT(contents, 119, ScalarInteger(internal->dim_popinitF_3));
  SET_VECTOR_ELT(contents, 120, ScalarInteger(internal->dim_popinitF_4));
  SET_VECTOR_ELT(contents, 121, ScalarInteger(internal->dim_popinitF_5));
  SET_VECTOR_ELT(contents, 122, ScalarInteger(internal->dim_popinitF_6));
  SET_VECTOR_ELT(contents, 123, ScalarInteger(internal->dim_popinitM));
  SET_VECTOR_ELT(contents, 124, ScalarInteger(internal->dim_popinitM_1));
  SET_VECTOR_ELT(contents, 125, ScalarInteger(internal->dim_popinitM_12));
  SET_VECTOR_ELT(contents, 126, ScalarInteger(internal->dim_popinitM_123));
  SET_VECTOR_ELT(contents, 127, ScalarInteger(internal->dim_popinitM_1234));
  SET_VECTOR_ELT(contents, 128, ScalarInteger(internal->dim_popinitM_12345));
  SET_VECTOR_ELT(contents, 129, ScalarInteger(internal->dim_popinitM_2));
  SET_VECTOR_ELT(contents, 130, ScalarInteger(internal->dim_popinitM_3));
  SET_VECTOR_ELT(contents, 131, ScalarInteger(internal->dim_popinitM_4));
  SET_VECTOR_ELT(contents, 132, ScalarInteger(internal->dim_popinitM_5));
  SET_VECTOR_ELT(contents, 133, ScalarInteger(internal->dim_popinitM_6));
  SET_VECTOR_ELT(contents, 134, ScalarInteger(internal->dim_r));
  SET_VECTOR_ELT(contents, 135, ScalarInteger(internal->dim_RiskChange));
  SET_VECTOR_ELT(contents, 136, ScalarInteger(internal->dim_RiskChange_1));
  SET_VECTOR_ELT(contents, 137, ScalarInteger(internal->dim_RiskChange_12));
  SET_VECTOR_ELT(contents, 138, ScalarInteger(internal->dim_RiskChange_123));
  SET_VECTOR_ELT(contents, 139, ScalarInteger(internal->dim_RiskChange_1234));
  SET_VECTOR_ELT(contents, 140, ScalarInteger(internal->dim_RiskChange_12345));
  SET_VECTOR_ELT(contents, 141, ScalarInteger(internal->dim_RiskChange_123456));
  SET_VECTOR_ELT(contents, 142, ScalarInteger(internal->dim_RiskChange_2));
  SET_VECTOR_ELT(contents, 143, ScalarInteger(internal->dim_RiskChange_3));
  SET_VECTOR_ELT(contents, 144, ScalarInteger(internal->dim_RiskChange_4));
  SET_VECTOR_ELT(contents, 145, ScalarInteger(internal->dim_RiskChange_5));
  SET_VECTOR_ELT(contents, 146, ScalarInteger(internal->dim_RiskChange_6));
  SET_VECTOR_ELT(contents, 147, ScalarInteger(internal->dim_RiskChange_7));
  SET_VECTOR_ELT(contents, 148, ScalarInteger(internal->dim_RiskHazard));
  SET_VECTOR_ELT(contents, 149, ScalarInteger(internal->dim_RiskHazard_1));
  SET_VECTOR_ELT(contents, 150, ScalarInteger(internal->dim_RiskHazard_12));
  SET_VECTOR_ELT(contents, 151, ScalarInteger(internal->dim_RiskHazard_2));
  SET_VECTOR_ELT(contents, 152, ScalarInteger(internal->dim_RiskHazard_3));
  SET_VECTOR_ELT(contents, 153, ScalarInteger(internal->dim_RiskHazardData));
  SET_VECTOR_ELT(contents, 154, ScalarInteger(internal->dim_RiskHazardData_1));
  SET_VECTOR_ELT(contents, 155, ScalarInteger(internal->dim_RiskHazardData_12));
  SET_VECTOR_ELT(contents, 156, ScalarInteger(internal->dim_RiskHazardData_123));
  SET_VECTOR_ELT(contents, 157, ScalarInteger(internal->dim_RiskHazardData_2));
  SET_VECTOR_ELT(contents, 158, ScalarInteger(internal->dim_RiskHazardData_3));
  SET_VECTOR_ELT(contents, 159, ScalarInteger(internal->dim_RiskHazardData_4));
  SET_VECTOR_ELT(contents, 160, ScalarInteger(internal->dim_tbbottom));
  SET_VECTOR_ELT(contents, 161, ScalarInteger(internal->dim_tbbottom_1));
  SET_VECTOR_ELT(contents, 162, ScalarInteger(internal->dim_tbbottom_12));
  SET_VECTOR_ELT(contents, 163, ScalarInteger(internal->dim_tbbottom_2));
  SET_VECTOR_ELT(contents, 164, ScalarInteger(internal->dim_tbbottom_3));
  SET_VECTOR_ELT(contents, 165, ScalarInteger(internal->dim_ttp));
  SEXP immigration_female = PROTECT(allocVector(REALSXP, internal->dim_immigration_female));
  memcpy(REAL(immigration_female), internal->immigration_female, internal->dim_immigration_female * sizeof(double));
  odin_set_dim(immigration_female, 2, internal->dim_immigration_female_1, internal->dim_immigration_female_2);
  SET_VECTOR_ELT(contents, 166, immigration_female);
  SEXP immigration_male = PROTECT(allocVector(REALSXP, internal->dim_immigration_male));
  memcpy(REAL(immigration_male), internal->immigration_male, internal->dim_immigration_male * sizeof(double));
  odin_set_dim(immigration_male, 2, internal->dim_immigration_male_1, internal->dim_immigration_male_2);
  SET_VECTOR_ELT(contents, 167, immigration_male);
  SEXP InF = PROTECT(allocVector(REALSXP, internal->dim_InF));
  memcpy(REAL(InF), internal->InF, internal->dim_InF * sizeof(double));
  SET_VECTOR_ELT(contents, 168, InF);
  SEXP initial_N = PROTECT(allocVector(REALSXP, internal->dim_N));
  memcpy(REAL(initial_N), internal->initial_N, internal->dim_N * sizeof(double));
  odin_set_dim(initial_N, 7, internal->dim_N_1, internal->dim_N_2, internal->dim_N_3, internal->dim_N_4, internal->dim_N_5, internal->dim_N_6, internal->dim_N_7);
  SET_VECTOR_ELT(contents, 169, initial_N);
  SEXP InM = PROTECT(allocVector(REALSXP, internal->dim_InM));
  memcpy(REAL(InM), internal->InM, internal->dim_InM * sizeof(double));
  SET_VECTOR_ELT(contents, 170, InM);
  SET_VECTOR_ELT(contents, 178, ScalarInteger(internal->lttp));
  SEXP migrage = PROTECT(allocVector(REALSXP, internal->dim_migrage));
  memcpy(REAL(migrage), internal->migrage, internal->dim_migrage * sizeof(double));
  SET_VECTOR_ELT(contents, 179, migrage);
  SEXP migrF = PROTECT(allocVector(REALSXP, internal->dim_migrF));
  memcpy(REAL(migrF), internal->migrF, internal->dim_migrF * sizeof(double));
  odin_set_dim(migrF, 6, internal->dim_migrF_1, internal->dim_migrF_2, internal->dim_migrF_3, internal->dim_migrF_4, internal->dim_migrF_5, internal->dim_migrF_6);
  SET_VECTOR_ELT(contents, 180, migrF);
  SEXP migrFagein = PROTECT(allocVector(REALSXP, internal->dim_migrFagein));
  memcpy(REAL(migrFagein), internal->migrFagein, internal->dim_migrFagein * sizeof(double));
  odin_set_dim(migrFagein, 6, internal->dim_migrFagein_1, internal->dim_migrFagein_2, internal->dim_migrFagein_3, internal->dim_migrFagein_4, internal->dim_migrFagein_5, internal->dim_migrFagein_6);
  SET_VECTOR_ELT(contents, 181, migrFagein);
  SEXP migrFageout = PROTECT(allocVector(REALSXP, internal->dim_migrFageout));
  memcpy(REAL(migrFageout), internal->migrFageout, internal->dim_migrFageout * sizeof(double));
  odin_set_dim(migrFageout, 6, internal->dim_migrFageout_1, internal->dim_migrFageout_2, internal->dim_migrFageout_3, internal->dim_migrFageout_4, internal->dim_migrFageout_5, internal->dim_migrFageout_6);
  SET_VECTOR_ELT(contents, 182, migrFageout);
  SEXP migrM = PROTECT(allocVector(REALSXP, internal->dim_migrM));
  memcpy(REAL(migrM), internal->migrM, internal->dim_migrM * sizeof(double));
  odin_set_dim(migrM, 6, internal->dim_migrM_1, internal->dim_migrM_2, internal->dim_migrM_3, internal->dim_migrM_4, internal->dim_migrM_5, internal->dim_migrM_6);
  SET_VECTOR_ELT(contents, 183, migrM);
  SEXP migrMagein = PROTECT(allocVector(REALSXP, internal->dim_migrMagein));
  memcpy(REAL(migrMagein), internal->migrMagein, internal->dim_migrMagein * sizeof(double));
  odin_set_dim(migrMagein, 6, internal->dim_migrMagein_1, internal->dim_migrMagein_2, internal->dim_migrMagein_3, internal->dim_migrMagein_4, internal->dim_migrMagein_5, internal->dim_migrMagein_6);
  SET_VECTOR_ELT(contents, 184, migrMagein);
  SEXP migrMageout = PROTECT(allocVector(REALSXP, internal->dim_migrMageout));
  memcpy(REAL(migrMageout), internal->migrMageout, internal->dim_migrMageout * sizeof(double));
  odin_set_dim(migrMageout, 6, internal->dim_migrMageout_1, internal->dim_migrMageout_2, internal->dim_migrMageout_3, internal->dim_migrMageout_4, internal->dim_migrMageout_5, internal->dim_migrMageout_6);
  SET_VECTOR_ELT(contents, 185, migrMageout);
  SET_VECTOR_ELT(contents, 186, ScalarInteger(internal->nage));
  SEXP native = PROTECT(allocVector(REALSXP, internal->dim_native));
  memcpy(REAL(native), internal->native, internal->dim_native * sizeof(double));
  SET_VECTOR_ELT(contents, 187, native);
  SET_VECTOR_ELT(contents, 188, ScalarInteger(internal->nnat));
  SET_VECTOR_ELT(contents, 189, ScalarInteger(internal->npost));
  SET_VECTOR_ELT(contents, 190, ScalarInteger(internal->nprot));
  SET_VECTOR_ELT(contents, 191, ScalarInteger(internal->nrisk));
  SET_VECTOR_ELT(contents, 192, ScalarInteger(internal->nstrain));
  SEXP omegaF = PROTECT(allocVector(REALSXP, internal->dim_omegaF));
  memcpy(REAL(omegaF), internal->omegaF, internal->dim_omegaF * sizeof(double));
  SET_VECTOR_ELT(contents, 193, omegaF);
  SEXP omegaM = PROTECT(allocVector(REALSXP, internal->dim_omegaM));
  memcpy(REAL(omegaM), internal->omegaM, internal->dim_omegaM * sizeof(double));
  SET_VECTOR_ELT(contents, 194, omegaM);
  SEXP Pmigr_nat = PROTECT(allocVector(REALSXP, internal->dim_Pmigr_nat));
  memcpy(REAL(Pmigr_nat), internal->Pmigr_nat, internal->dim_Pmigr_nat * sizeof(double));
  SET_VECTOR_ELT(contents, 195, Pmigr_nat);
  SEXP PmigrF_post = PROTECT(allocVector(REALSXP, internal->dim_PmigrF_post));
  memcpy(REAL(PmigrF_post), internal->PmigrF_post, internal->dim_PmigrF_post * sizeof(double));
  SET_VECTOR_ELT(contents, 196, PmigrF_post);
  SEXP PmigrF_prot = PROTECT(allocVector(REALSXP, internal->dim_PmigrF_prot));
  memcpy(REAL(PmigrF_prot), internal->PmigrF_prot, internal->dim_PmigrF_prot * sizeof(double));
  SET_VECTOR_ELT(contents, 197, PmigrF_prot);
  SEXP PmigrF_risk = PROTECT(allocVector(REALSXP, internal->dim_PmigrF_risk));
  memcpy(REAL(PmigrF_risk), internal->PmigrF_risk, internal->dim_PmigrF_risk * sizeof(double));
  SET_VECTOR_ELT(contents, 198, PmigrF_risk);
  SEXP PmigrF_strain = PROTECT(allocVector(REALSXP, internal->dim_PmigrF_strain));
  memcpy(REAL(PmigrF_strain), internal->PmigrF_strain, internal->dim_PmigrF_strain * sizeof(double));
  SET_VECTOR_ELT(contents, 199, PmigrF_strain);
  SEXP PmigrM_post = PROTECT(allocVector(REALSXP, internal->dim_PmigrM_post));
  memcpy(REAL(PmigrM_post), internal->PmigrM_post, internal->dim_PmigrM_post * sizeof(double));
  SET_VECTOR_ELT(contents, 200, PmigrM_post);
  SEXP PmigrM_prot = PROTECT(allocVector(REALSXP, internal->dim_PmigrM_prot));
  memcpy(REAL(PmigrM_prot), internal->PmigrM_prot, internal->dim_PmigrM_prot * sizeof(double));
  SET_VECTOR_ELT(contents, 201, PmigrM_prot);
  SEXP PmigrM_risk = PROTECT(allocVector(REALSXP, internal->dim_PmigrM_risk));
  memcpy(REAL(PmigrM_risk), internal->PmigrM_risk, internal->dim_PmigrM_risk * sizeof(double));
  SET_VECTOR_ELT(contents, 202, PmigrM_risk);
  SEXP PmigrM_strain = PROTECT(allocVector(REALSXP, internal->dim_PmigrM_strain));
  memcpy(REAL(PmigrM_strain), internal->PmigrM_strain, internal->dim_PmigrM_strain * sizeof(double));
  SET_VECTOR_ELT(contents, 203, PmigrM_strain);
  SEXP popdatF = PROTECT(allocVector(REALSXP, internal->dim_popdatF));
  memcpy(REAL(popdatF), internal->popdatF, internal->dim_popdatF * sizeof(double));
  odin_set_dim(popdatF, 2, internal->dim_popdatF_1, internal->dim_popdatF_2);
  SET_VECTOR_ELT(contents, 204, popdatF);
  SEXP popdatM = PROTECT(allocVector(REALSXP, internal->dim_popdatM));
  memcpy(REAL(popdatM), internal->popdatM, internal->dim_popdatM * sizeof(double));
  odin_set_dim(popdatM, 2, internal->dim_popdatM_1, internal->dim_popdatM_2);
  SET_VECTOR_ELT(contents, 205, popdatM);
  SEXP popinitF = PROTECT(allocVector(REALSXP, internal->dim_popinitF));
  memcpy(REAL(popinitF), internal->popinitF, internal->dim_popinitF * sizeof(double));
  odin_set_dim(popinitF, 6, internal->dim_popinitF_1, internal->dim_popinitF_2, internal->dim_popinitF_3, internal->dim_popinitF_4, internal->dim_popinitF_5, internal->dim_popinitF_6);
  SET_VECTOR_ELT(contents, 206, popinitF);
  SEXP popinitM = PROTECT(allocVector(REALSXP, internal->dim_popinitM));
  memcpy(REAL(popinitM), internal->popinitM, internal->dim_popinitM * sizeof(double));
  odin_set_dim(popinitM, 6, internal->dim_popinitM_1, internal->dim_popinitM_2, internal->dim_popinitM_3, internal->dim_popinitM_4, internal->dim_popinitM_5, internal->dim_popinitM_6);
  SET_VECTOR_ELT(contents, 207, popinitM);
  SEXP r = PROTECT(allocVector(REALSXP, internal->dim_r));
  memcpy(REAL(r), internal->r, internal->dim_r * sizeof(double));
  SET_VECTOR_ELT(contents, 208, r);
  SEXP RiskChange = PROTECT(allocVector(REALSXP, internal->dim_RiskChange));
  memcpy(REAL(RiskChange), internal->RiskChange, internal->dim_RiskChange * sizeof(double));
  odin_set_dim(RiskChange, 7, internal->dim_RiskChange_1, internal->dim_RiskChange_2, internal->dim_RiskChange_3, internal->dim_RiskChange_4, internal->dim_RiskChange_5, internal->dim_RiskChange_6, internal->dim_RiskChange_7);
  SET_VECTOR_ELT(contents, 209, RiskChange);
  SEXP RiskHazard = PROTECT(allocVector(REALSXP, internal->dim_RiskHazard));
  memcpy(REAL(RiskHazard), internal->RiskHazard, internal->dim_RiskHazard * sizeof(double));
  odin_set_dim(RiskHazard, 3, internal->dim_RiskHazard_1, internal->dim_RiskHazard_2, internal->dim_RiskHazard_3);
  SET_VECTOR_ELT(contents, 210, RiskHazard);
  SEXP RiskHazardData = PROTECT(allocVector(REALSXP, internal->dim_RiskHazardData));
  memcpy(REAL(RiskHazardData), internal->RiskHazardData, internal->dim_RiskHazardData * sizeof(double));
  odin_set_dim(RiskHazardData, 4, internal->dim_RiskHazardData_1, internal->dim_RiskHazardData_2, internal->dim_RiskHazardData_3, internal->dim_RiskHazardData_4);
  SET_VECTOR_ELT(contents, 211, RiskHazardData);
  SEXP tbbottom = PROTECT(allocVector(REALSXP, internal->dim_tbbottom));
  memcpy(REAL(tbbottom), internal->tbbottom, internal->dim_tbbottom * sizeof(double));
  odin_set_dim(tbbottom, 3, internal->dim_tbbottom_1, internal->dim_tbbottom_2, internal->dim_tbbottom_3);
  SET_VECTOR_ELT(contents, 212, tbbottom);
  SEXP ttp = PROTECT(allocVector(REALSXP, internal->dim_ttp));
  memcpy(REAL(ttp), internal->ttp, internal->dim_ttp * sizeof(double));
  SET_VECTOR_ELT(contents, 213, ttp);
  SEXP nms = PROTECT(allocVector(STRSXP, 214));
  SET_STRING_ELT(nms, 0, mkChar("BF"));
  SET_STRING_ELT(nms, 1, mkChar("birthrisk"));
  SET_STRING_ELT(nms, 2, mkChar("BM"));
  SET_STRING_ELT(nms, 3, mkChar("dim_BF"));
  SET_STRING_ELT(nms, 4, mkChar("dim_birthrisk"));
  SET_STRING_ELT(nms, 5, mkChar("dim_BM"));
  SET_STRING_ELT(nms, 6, mkChar("dim_immigration_female"));
  SET_STRING_ELT(nms, 7, mkChar("dim_immigration_female_1"));
  SET_STRING_ELT(nms, 8, mkChar("dim_immigration_female_2"));
  SET_STRING_ELT(nms, 9, mkChar("dim_immigration_male"));
  SET_STRING_ELT(nms, 10, mkChar("dim_immigration_male_1"));
  SET_STRING_ELT(nms, 11, mkChar("dim_immigration_male_2"));
  SET_STRING_ELT(nms, 12, mkChar("dim_InF"));
  SET_STRING_ELT(nms, 13, mkChar("dim_InM"));
  SET_STRING_ELT(nms, 14, mkChar("dim_migrage"));
  SET_STRING_ELT(nms, 15, mkChar("dim_migrF"));
  SET_STRING_ELT(nms, 16, mkChar("dim_migrF_1"));
  SET_STRING_ELT(nms, 17, mkChar("dim_migrF_12"));
  SET_STRING_ELT(nms, 18, mkChar("dim_migrF_123"));
  SET_STRING_ELT(nms, 19, mkChar("dim_migrF_1234"));
  SET_STRING_ELT(nms, 20, mkChar("dim_migrF_12345"));
  SET_STRING_ELT(nms, 21, mkChar("dim_migrF_2"));
  SET_STRING_ELT(nms, 22, mkChar("dim_migrF_3"));
  SET_STRING_ELT(nms, 23, mkChar("dim_migrF_4"));
  SET_STRING_ELT(nms, 24, mkChar("dim_migrF_5"));
  SET_STRING_ELT(nms, 25, mkChar("dim_migrF_6"));
  SET_STRING_ELT(nms, 26, mkChar("dim_migrFagein"));
  SET_STRING_ELT(nms, 27, mkChar("dim_migrFagein_1"));
  SET_STRING_ELT(nms, 28, mkChar("dim_migrFagein_12"));
  SET_STRING_ELT(nms, 29, mkChar("dim_migrFagein_123"));
  SET_STRING_ELT(nms, 30, mkChar("dim_migrFagein_1234"));
  SET_STRING_ELT(nms, 31, mkChar("dim_migrFagein_12345"));
  SET_STRING_ELT(nms, 32, mkChar("dim_migrFagein_2"));
  SET_STRING_ELT(nms, 33, mkChar("dim_migrFagein_3"));
  SET_STRING_ELT(nms, 34, mkChar("dim_migrFagein_4"));
  SET_STRING_ELT(nms, 35, mkChar("dim_migrFagein_5"));
  SET_STRING_ELT(nms, 36, mkChar("dim_migrFagein_6"));
  SET_STRING_ELT(nms, 37, mkChar("dim_migrFageout"));
  SET_STRING_ELT(nms, 38, mkChar("dim_migrFageout_1"));
  SET_STRING_ELT(nms, 39, mkChar("dim_migrFageout_12"));
  SET_STRING_ELT(nms, 40, mkChar("dim_migrFageout_123"));
  SET_STRING_ELT(nms, 41, mkChar("dim_migrFageout_1234"));
  SET_STRING_ELT(nms, 42, mkChar("dim_migrFageout_12345"));
  SET_STRING_ELT(nms, 43, mkChar("dim_migrFageout_2"));
  SET_STRING_ELT(nms, 44, mkChar("dim_migrFageout_3"));
  SET_STRING_ELT(nms, 45, mkChar("dim_migrFageout_4"));
  SET_STRING_ELT(nms, 46, mkChar("dim_migrFageout_5"));
  SET_STRING_ELT(nms, 47, mkChar("dim_migrFageout_6"));
  SET_STRING_ELT(nms, 48, mkChar("dim_migrM"));
  SET_STRING_ELT(nms, 49, mkChar("dim_migrM_1"));
  SET_STRING_ELT(nms, 50, mkChar("dim_migrM_12"));
  SET_STRING_ELT(nms, 51, mkChar("dim_migrM_123"));
  SET_STRING_ELT(nms, 52, mkChar("dim_migrM_1234"));
  SET_STRING_ELT(nms, 53, mkChar("dim_migrM_12345"));
  SET_STRING_ELT(nms, 54, mkChar("dim_migrM_2"));
  SET_STRING_ELT(nms, 55, mkChar("dim_migrM_3"));
  SET_STRING_ELT(nms, 56, mkChar("dim_migrM_4"));
  SET_STRING_ELT(nms, 57, mkChar("dim_migrM_5"));
  SET_STRING_ELT(nms, 58, mkChar("dim_migrM_6"));
  SET_STRING_ELT(nms, 59, mkChar("dim_migrMagein"));
  SET_STRING_ELT(nms, 60, mkChar("dim_migrMagein_1"));
  SET_STRING_ELT(nms, 61, mkChar("dim_migrMagein_12"));
  SET_STRING_ELT(nms, 62, mkChar("dim_migrMagein_123"));
  SET_STRING_ELT(nms, 63, mkChar("dim_migrMagein_1234"));
  SET_STRING_ELT(nms, 64, mkChar("dim_migrMagein_12345"));
  SET_STRING_ELT(nms, 65, mkChar("dim_migrMagein_2"));
  SET_STRING_ELT(nms, 66, mkChar("dim_migrMagein_3"));
  SET_STRING_ELT(nms, 67, mkChar("dim_migrMagein_4"));
  SET_STRING_ELT(nms, 68, mkChar("dim_migrMagein_5"));
  SET_STRING_ELT(nms, 69, mkChar("dim_migrMagein_6"));
  SET_STRING_ELT(nms, 70, mkChar("dim_migrMageout"));
  SET_STRING_ELT(nms, 71, mkChar("dim_migrMageout_1"));
  SET_STRING_ELT(nms, 72, mkChar("dim_migrMageout_12"));
  SET_STRING_ELT(nms, 73, mkChar("dim_migrMageout_123"));
  SET_STRING_ELT(nms, 74, mkChar("dim_migrMageout_1234"));
  SET_STRING_ELT(nms, 75, mkChar("dim_migrMageout_12345"));
  SET_STRING_ELT(nms, 76, mkChar("dim_migrMageout_2"));
  SET_STRING_ELT(nms, 77, mkChar("dim_migrMageout_3"));
  SET_STRING_ELT(nms, 78, mkChar("dim_migrMageout_4"));
  SET_STRING_ELT(nms, 79, mkChar("dim_migrMageout_5"));
  SET_STRING_ELT(nms, 80, mkChar("dim_migrMageout_6"));
  SET_STRING_ELT(nms, 81, mkChar("dim_N"));
  SET_STRING_ELT(nms, 82, mkChar("dim_N_1"));
  SET_STRING_ELT(nms, 83, mkChar("dim_N_12"));
  SET_STRING_ELT(nms, 84, mkChar("dim_N_123"));
  SET_STRING_ELT(nms, 85, mkChar("dim_N_1234"));
  SET_STRING_ELT(nms, 86, mkChar("dim_N_12345"));
  SET_STRING_ELT(nms, 87, mkChar("dim_N_123456"));
  SET_STRING_ELT(nms, 88, mkChar("dim_N_2"));
  SET_STRING_ELT(nms, 89, mkChar("dim_N_3"));
  SET_STRING_ELT(nms, 90, mkChar("dim_N_4"));
  SET_STRING_ELT(nms, 91, mkChar("dim_N_5"));
  SET_STRING_ELT(nms, 92, mkChar("dim_N_6"));
  SET_STRING_ELT(nms, 93, mkChar("dim_N_7"));
  SET_STRING_ELT(nms, 94, mkChar("dim_native"));
  SET_STRING_ELT(nms, 95, mkChar("dim_omegaF"));
  SET_STRING_ELT(nms, 96, mkChar("dim_omegaM"));
  SET_STRING_ELT(nms, 97, mkChar("dim_Pmigr_nat"));
  SET_STRING_ELT(nms, 98, mkChar("dim_PmigrF_post"));
  SET_STRING_ELT(nms, 99, mkChar("dim_PmigrF_prot"));
  SET_STRING_ELT(nms, 100, mkChar("dim_PmigrF_risk"));
  SET_STRING_ELT(nms, 101, mkChar("dim_PmigrF_strain"));
  SET_STRING_ELT(nms, 102, mkChar("dim_PmigrM_post"));
  SET_STRING_ELT(nms, 103, mkChar("dim_PmigrM_prot"));
  SET_STRING_ELT(nms, 104, mkChar("dim_PmigrM_risk"));
  SET_STRING_ELT(nms, 105, mkChar("dim_PmigrM_strain"));
  SET_STRING_ELT(nms, 106, mkChar("dim_popdatF"));
  SET_STRING_ELT(nms, 107, mkChar("dim_popdatF_1"));
  SET_STRING_ELT(nms, 108, mkChar("dim_popdatF_2"));
  SET_STRING_ELT(nms, 109, mkChar("dim_popdatM"));
  SET_STRING_ELT(nms, 110, mkChar("dim_popdatM_1"));
  SET_STRING_ELT(nms, 111, mkChar("dim_popdatM_2"));
  SET_STRING_ELT(nms, 112, mkChar("dim_popinitF"));
  SET_STRING_ELT(nms, 113, mkChar("dim_popinitF_1"));
  SET_STRING_ELT(nms, 114, mkChar("dim_popinitF_12"));
  SET_STRING_ELT(nms, 115, mkChar("dim_popinitF_123"));
  SET_STRING_ELT(nms, 116, mkChar("dim_popinitF_1234"));
  SET_STRING_ELT(nms, 117, mkChar("dim_popinitF_12345"));
  SET_STRING_ELT(nms, 118, mkChar("dim_popinitF_2"));
  SET_STRING_ELT(nms, 119, mkChar("dim_popinitF_3"));
  SET_STRING_ELT(nms, 120, mkChar("dim_popinitF_4"));
  SET_STRING_ELT(nms, 121, mkChar("dim_popinitF_5"));
  SET_STRING_ELT(nms, 122, mkChar("dim_popinitF_6"));
  SET_STRING_ELT(nms, 123, mkChar("dim_popinitM"));
  SET_STRING_ELT(nms, 124, mkChar("dim_popinitM_1"));
  SET_STRING_ELT(nms, 125, mkChar("dim_popinitM_12"));
  SET_STRING_ELT(nms, 126, mkChar("dim_popinitM_123"));
  SET_STRING_ELT(nms, 127, mkChar("dim_popinitM_1234"));
  SET_STRING_ELT(nms, 128, mkChar("dim_popinitM_12345"));
  SET_STRING_ELT(nms, 129, mkChar("dim_popinitM_2"));
  SET_STRING_ELT(nms, 130, mkChar("dim_popinitM_3"));
  SET_STRING_ELT(nms, 131, mkChar("dim_popinitM_4"));
  SET_STRING_ELT(nms, 132, mkChar("dim_popinitM_5"));
  SET_STRING_ELT(nms, 133, mkChar("dim_popinitM_6"));
  SET_STRING_ELT(nms, 134, mkChar("dim_r"));
  SET_STRING_ELT(nms, 135, mkChar("dim_RiskChange"));
  SET_STRING_ELT(nms, 136, mkChar("dim_RiskChange_1"));
  SET_STRING_ELT(nms, 137, mkChar("dim_RiskChange_12"));
  SET_STRING_ELT(nms, 138, mkChar("dim_RiskChange_123"));
  SET_STRING_ELT(nms, 139, mkChar("dim_RiskChange_1234"));
  SET_STRING_ELT(nms, 140, mkChar("dim_RiskChange_12345"));
  SET_STRING_ELT(nms, 141, mkChar("dim_RiskChange_123456"));
  SET_STRING_ELT(nms, 142, mkChar("dim_RiskChange_2"));
  SET_STRING_ELT(nms, 143, mkChar("dim_RiskChange_3"));
  SET_STRING_ELT(nms, 144, mkChar("dim_RiskChange_4"));
  SET_STRING_ELT(nms, 145, mkChar("dim_RiskChange_5"));
  SET_STRING_ELT(nms, 146, mkChar("dim_RiskChange_6"));
  SET_STRING_ELT(nms, 147, mkChar("dim_RiskChange_7"));
  SET_STRING_ELT(nms, 148, mkChar("dim_RiskHazard"));
  SET_STRING_ELT(nms, 149, mkChar("dim_RiskHazard_1"));
  SET_STRING_ELT(nms, 150, mkChar("dim_RiskHazard_12"));
  SET_STRING_ELT(nms, 151, mkChar("dim_RiskHazard_2"));
  SET_STRING_ELT(nms, 152, mkChar("dim_RiskHazard_3"));
  SET_STRING_ELT(nms, 153, mkChar("dim_RiskHazardData"));
  SET_STRING_ELT(nms, 154, mkChar("dim_RiskHazardData_1"));
  SET_STRING_ELT(nms, 155, mkChar("dim_RiskHazardData_12"));
  SET_STRING_ELT(nms, 156, mkChar("dim_RiskHazardData_123"));
  SET_STRING_ELT(nms, 157, mkChar("dim_RiskHazardData_2"));
  SET_STRING_ELT(nms, 158, mkChar("dim_RiskHazardData_3"));
  SET_STRING_ELT(nms, 159, mkChar("dim_RiskHazardData_4"));
  SET_STRING_ELT(nms, 160, mkChar("dim_tbbottom"));
  SET_STRING_ELT(nms, 161, mkChar("dim_tbbottom_1"));
  SET_STRING_ELT(nms, 162, mkChar("dim_tbbottom_12"));
  SET_STRING_ELT(nms, 163, mkChar("dim_tbbottom_2"));
  SET_STRING_ELT(nms, 164, mkChar("dim_tbbottom_3"));
  SET_STRING_ELT(nms, 165, mkChar("dim_ttp"));
  SET_STRING_ELT(nms, 166, mkChar("immigration_female"));
  SET_STRING_ELT(nms, 167, mkChar("immigration_male"));
  SET_STRING_ELT(nms, 168, mkChar("InF"));
  SET_STRING_ELT(nms, 169, mkChar("initial_N"));
  SET_STRING_ELT(nms, 170, mkChar("InM"));
  SET_STRING_ELT(nms, 171, mkChar("interpolate_bzf"));
  SET_STRING_ELT(nms, 172, mkChar("interpolate_bzm"));
  SET_STRING_ELT(nms, 173, mkChar("interpolate_InF"));
  SET_STRING_ELT(nms, 174, mkChar("interpolate_InM"));
  SET_STRING_ELT(nms, 175, mkChar("interpolate_omegaF"));
  SET_STRING_ELT(nms, 176, mkChar("interpolate_omegaM"));
  SET_STRING_ELT(nms, 177, mkChar("interpolate_RiskHazard"));
  SET_STRING_ELT(nms, 178, mkChar("lttp"));
  SET_STRING_ELT(nms, 179, mkChar("migrage"));
  SET_STRING_ELT(nms, 180, mkChar("migrF"));
  SET_STRING_ELT(nms, 181, mkChar("migrFagein"));
  SET_STRING_ELT(nms, 182, mkChar("migrFageout"));
  SET_STRING_ELT(nms, 183, mkChar("migrM"));
  SET_STRING_ELT(nms, 184, mkChar("migrMagein"));
  SET_STRING_ELT(nms, 185, mkChar("migrMageout"));
  SET_STRING_ELT(nms, 186, mkChar("nage"));
  SET_STRING_ELT(nms, 187, mkChar("native"));
  SET_STRING_ELT(nms, 188, mkChar("nnat"));
  SET_STRING_ELT(nms, 189, mkChar("npost"));
  SET_STRING_ELT(nms, 190, mkChar("nprot"));
  SET_STRING_ELT(nms, 191, mkChar("nrisk"));
  SET_STRING_ELT(nms, 192, mkChar("nstrain"));
  SET_STRING_ELT(nms, 193, mkChar("omegaF"));
  SET_STRING_ELT(nms, 194, mkChar("omegaM"));
  SET_STRING_ELT(nms, 195, mkChar("Pmigr_nat"));
  SET_STRING_ELT(nms, 196, mkChar("PmigrF_post"));
  SET_STRING_ELT(nms, 197, mkChar("PmigrF_prot"));
  SET_STRING_ELT(nms, 198, mkChar("PmigrF_risk"));
  SET_STRING_ELT(nms, 199, mkChar("PmigrF_strain"));
  SET_STRING_ELT(nms, 200, mkChar("PmigrM_post"));
  SET_STRING_ELT(nms, 201, mkChar("PmigrM_prot"));
  SET_STRING_ELT(nms, 202, mkChar("PmigrM_risk"));
  SET_STRING_ELT(nms, 203, mkChar("PmigrM_strain"));
  SET_STRING_ELT(nms, 204, mkChar("popdatF"));
  SET_STRING_ELT(nms, 205, mkChar("popdatM"));
  SET_STRING_ELT(nms, 206, mkChar("popinitF"));
  SET_STRING_ELT(nms, 207, mkChar("popinitM"));
  SET_STRING_ELT(nms, 208, mkChar("r"));
  SET_STRING_ELT(nms, 209, mkChar("RiskChange"));
  SET_STRING_ELT(nms, 210, mkChar("RiskHazard"));
  SET_STRING_ELT(nms, 211, mkChar("RiskHazardData"));
  SET_STRING_ELT(nms, 212, mkChar("tbbottom"));
  SET_STRING_ELT(nms, 213, mkChar("ttp"));
  setAttrib(contents, R_NamesSymbol, nms);
  UNPROTECT(39);
  return contents;
}
SEXP ocaode_set_user(SEXP internal_p, SEXP user) {
  ocaode_internal *internal = ocaode_get_internal(internal_p, 1);
  internal->nage = user_get_scalar_int(user, "nage", internal->nage, NA_REAL, NA_REAL);
  internal->nnat = user_get_scalar_int(user, "nnat", internal->nnat, NA_REAL, NA_REAL);
  internal->npost = user_get_scalar_int(user, "npost", internal->npost, NA_REAL, NA_REAL);
  internal->nprot = user_get_scalar_int(user, "nprot", internal->nprot, NA_REAL, NA_REAL);
  internal->nrisk = user_get_scalar_int(user, "nrisk", internal->nrisk, NA_REAL, NA_REAL);
  internal->nstrain = user_get_scalar_int(user, "nstrain", internal->nstrain, NA_REAL, NA_REAL);
  internal->ttp = (double*) user_get_array_dim(user, false, internal->ttp, "ttp", 1, NA_REAL, NA_REAL, &internal->dim_ttp);
  internal->dim_birthrisk = internal->nrisk;
  internal->dim_InF = internal->nage;
  internal->dim_InM = internal->nage;
  internal->dim_migrage = internal->nnat;
  internal->dim_migrF_1 = internal->nage;
  internal->dim_migrF_2 = internal->nnat;
  internal->dim_migrF_3 = internal->nrisk;
  internal->dim_migrF_4 = internal->npost;
  internal->dim_migrF_5 = internal->nstrain;
  internal->dim_migrF_6 = internal->nprot;
  internal->dim_migrFagein_1 = internal->nage;
  internal->dim_migrFagein_2 = internal->nnat;
  internal->dim_migrFagein_3 = internal->nrisk;
  internal->dim_migrFagein_4 = internal->npost;
  internal->dim_migrFagein_5 = internal->nstrain;
  internal->dim_migrFagein_6 = internal->nprot;
  internal->dim_migrFageout_1 = internal->nage;
  internal->dim_migrFageout_2 = internal->nnat;
  internal->dim_migrFageout_3 = internal->nrisk;
  internal->dim_migrFageout_4 = internal->npost;
  internal->dim_migrFageout_5 = internal->nstrain;
  internal->dim_migrFageout_6 = internal->nprot;
  internal->dim_migrM_1 = internal->nage;
  internal->dim_migrM_2 = internal->nnat;
  internal->dim_migrM_3 = internal->nrisk;
  internal->dim_migrM_4 = internal->npost;
  internal->dim_migrM_5 = internal->nstrain;
  internal->dim_migrM_6 = internal->nprot;
  internal->dim_migrMagein_1 = internal->nage;
  internal->dim_migrMagein_2 = internal->nnat;
  internal->dim_migrMagein_3 = internal->nrisk;
  internal->dim_migrMagein_4 = internal->npost;
  internal->dim_migrMagein_5 = internal->nstrain;
  internal->dim_migrMagein_6 = internal->nprot;
  internal->dim_migrMageout_1 = internal->nage;
  internal->dim_migrMageout_2 = internal->nnat;
  internal->dim_migrMageout_3 = internal->nrisk;
  internal->dim_migrMageout_4 = internal->npost;
  internal->dim_migrMageout_5 = internal->nstrain;
  internal->dim_migrMageout_6 = internal->nprot;
  internal->dim_N_1 = internal->nage;
  internal->dim_N_2 = 2;
  internal->dim_N_3 = internal->nnat;
  internal->dim_N_4 = internal->nrisk;
  internal->dim_N_5 = internal->npost;
  internal->dim_N_6 = internal->nstrain;
  internal->dim_N_7 = internal->nprot;
  internal->dim_native = internal->nnat;
  internal->dim_omegaF = internal->nage;
  internal->dim_omegaM = internal->nage;
  internal->dim_Pmigr_nat = internal->nnat;
  internal->dim_PmigrF_post = internal->npost;
  internal->dim_PmigrF_prot = internal->nprot;
  internal->dim_PmigrF_risk = internal->nrisk;
  internal->dim_PmigrF_strain = internal->nstrain;
  internal->dim_PmigrM_post = internal->npost;
  internal->dim_PmigrM_prot = internal->nprot;
  internal->dim_PmigrM_risk = internal->nrisk;
  internal->dim_PmigrM_strain = internal->nstrain;
  internal->dim_popinitF_1 = internal->nage;
  internal->dim_popinitF_2 = internal->nnat;
  internal->dim_popinitF_3 = internal->nrisk;
  internal->dim_popinitF_4 = internal->npost;
  internal->dim_popinitF_5 = internal->nstrain;
  internal->dim_popinitF_6 = internal->nprot;
  internal->dim_popinitM_1 = internal->nage;
  internal->dim_popinitM_2 = internal->nnat;
  internal->dim_popinitM_3 = internal->nrisk;
  internal->dim_popinitM_4 = internal->npost;
  internal->dim_popinitM_5 = internal->nstrain;
  internal->dim_popinitM_6 = internal->nprot;
  internal->dim_r = internal->nage;
  internal->dim_RiskChange_1 = internal->nage;
  internal->dim_RiskChange_2 = 2;
  internal->dim_RiskChange_3 = internal->nnat;
  internal->dim_RiskChange_4 = internal->nrisk;
  internal->dim_RiskChange_5 = internal->npost;
  internal->dim_RiskChange_6 = internal->nstrain;
  internal->dim_RiskChange_7 = internal->nprot;
  internal->dim_RiskHazard_1 = internal->nage;
  internal->dim_RiskHazard_2 = 2;
  internal->dim_RiskHazard_3 = internal->nrisk;
  internal->dim_tbbottom_1 = internal->npost;
  internal->dim_tbbottom_2 = internal->nstrain;
  internal->dim_tbbottom_3 = internal->nprot;
  R_Free(internal->InF);
  internal->InF = (double*) R_Calloc(internal->dim_InF, double);
  R_Free(internal->InM);
  internal->InM = (double*) R_Calloc(internal->dim_InM, double);
  R_Free(internal->native);
  internal->native = (double*) R_Calloc(internal->dim_native, double);
  R_Free(internal->omegaF);
  internal->omegaF = (double*) R_Calloc(internal->dim_omegaF, double);
  R_Free(internal->omegaM);
  internal->omegaM = (double*) R_Calloc(internal->dim_omegaM, double);
  R_Free(internal->Pmigr_nat);
  internal->Pmigr_nat = (double*) R_Calloc(internal->dim_Pmigr_nat, double);
  internal->birthrisk = (double*) user_get_array(user, false, internal->birthrisk, "birthrisk", NA_REAL, NA_REAL, 1, internal->dim_birthrisk);
  internal->dim_migrF = internal->dim_migrF_1 * internal->dim_migrF_2 * internal->dim_migrF_3 * internal->dim_migrF_4 * internal->dim_migrF_5 * internal->dim_migrF_6;
  internal->dim_migrF_12 = internal->dim_migrF_1 * internal->dim_migrF_2;
  internal->dim_migrF_123 = internal->dim_migrF_1 * internal->dim_migrF_2 * internal->dim_migrF_3;
  internal->dim_migrF_1234 = internal->dim_migrF_1 * internal->dim_migrF_2 * internal->dim_migrF_3 * internal->dim_migrF_4;
  internal->dim_migrF_12345 = internal->dim_migrF_1 * internal->dim_migrF_2 * internal->dim_migrF_3 * internal->dim_migrF_4 * internal->dim_migrF_5;
  internal->dim_migrFagein = internal->dim_migrFagein_1 * internal->dim_migrFagein_2 * internal->dim_migrFagein_3 * internal->dim_migrFagein_4 * internal->dim_migrFagein_5 * internal->dim_migrFagein_6;
  internal->dim_migrFagein_12 = internal->dim_migrFagein_1 * internal->dim_migrFagein_2;
  internal->dim_migrFagein_123 = internal->dim_migrFagein_1 * internal->dim_migrFagein_2 * internal->dim_migrFagein_3;
  internal->dim_migrFagein_1234 = internal->dim_migrFagein_1 * internal->dim_migrFagein_2 * internal->dim_migrFagein_3 * internal->dim_migrFagein_4;
  internal->dim_migrFagein_12345 = internal->dim_migrFagein_1 * internal->dim_migrFagein_2 * internal->dim_migrFagein_3 * internal->dim_migrFagein_4 * internal->dim_migrFagein_5;
  internal->dim_migrFageout = internal->dim_migrFageout_1 * internal->dim_migrFageout_2 * internal->dim_migrFageout_3 * internal->dim_migrFageout_4 * internal->dim_migrFageout_5 * internal->dim_migrFageout_6;
  internal->dim_migrFageout_12 = internal->dim_migrFageout_1 * internal->dim_migrFageout_2;
  internal->dim_migrFageout_123 = internal->dim_migrFageout_1 * internal->dim_migrFageout_2 * internal->dim_migrFageout_3;
  internal->dim_migrFageout_1234 = internal->dim_migrFageout_1 * internal->dim_migrFageout_2 * internal->dim_migrFageout_3 * internal->dim_migrFageout_4;
  internal->dim_migrFageout_12345 = internal->dim_migrFageout_1 * internal->dim_migrFageout_2 * internal->dim_migrFageout_3 * internal->dim_migrFageout_4 * internal->dim_migrFageout_5;
  internal->dim_migrM = internal->dim_migrM_1 * internal->dim_migrM_2 * internal->dim_migrM_3 * internal->dim_migrM_4 * internal->dim_migrM_5 * internal->dim_migrM_6;
  internal->dim_migrM_12 = internal->dim_migrM_1 * internal->dim_migrM_2;
  internal->dim_migrM_123 = internal->dim_migrM_1 * internal->dim_migrM_2 * internal->dim_migrM_3;
  internal->dim_migrM_1234 = internal->dim_migrM_1 * internal->dim_migrM_2 * internal->dim_migrM_3 * internal->dim_migrM_4;
  internal->dim_migrM_12345 = internal->dim_migrM_1 * internal->dim_migrM_2 * internal->dim_migrM_3 * internal->dim_migrM_4 * internal->dim_migrM_5;
  internal->dim_migrMagein = internal->dim_migrMagein_1 * internal->dim_migrMagein_2 * internal->dim_migrMagein_3 * internal->dim_migrMagein_4 * internal->dim_migrMagein_5 * internal->dim_migrMagein_6;
  internal->dim_migrMagein_12 = internal->dim_migrMagein_1 * internal->dim_migrMagein_2;
  internal->dim_migrMagein_123 = internal->dim_migrMagein_1 * internal->dim_migrMagein_2 * internal->dim_migrMagein_3;
  internal->dim_migrMagein_1234 = internal->dim_migrMagein_1 * internal->dim_migrMagein_2 * internal->dim_migrMagein_3 * internal->dim_migrMagein_4;
  internal->dim_migrMagein_12345 = internal->dim_migrMagein_1 * internal->dim_migrMagein_2 * internal->dim_migrMagein_3 * internal->dim_migrMagein_4 * internal->dim_migrMagein_5;
  internal->dim_migrMageout = internal->dim_migrMageout_1 * internal->dim_migrMageout_2 * internal->dim_migrMageout_3 * internal->dim_migrMageout_4 * internal->dim_migrMageout_5 * internal->dim_migrMageout_6;
  internal->dim_migrMageout_12 = internal->dim_migrMageout_1 * internal->dim_migrMageout_2;
  internal->dim_migrMageout_123 = internal->dim_migrMageout_1 * internal->dim_migrMageout_2 * internal->dim_migrMageout_3;
  internal->dim_migrMageout_1234 = internal->dim_migrMageout_1 * internal->dim_migrMageout_2 * internal->dim_migrMageout_3 * internal->dim_migrMageout_4;
  internal->dim_migrMageout_12345 = internal->dim_migrMageout_1 * internal->dim_migrMageout_2 * internal->dim_migrMageout_3 * internal->dim_migrMageout_4 * internal->dim_migrMageout_5;
  internal->dim_N = internal->dim_N_1 * internal->dim_N_2 * internal->dim_N_3 * internal->dim_N_4 * internal->dim_N_5 * internal->dim_N_6 * internal->dim_N_7;
  internal->dim_N_12 = internal->dim_N_1 * internal->dim_N_2;
  internal->dim_N_123 = internal->dim_N_1 * internal->dim_N_2 * internal->dim_N_3;
  internal->dim_N_1234 = internal->dim_N_1 * internal->dim_N_2 * internal->dim_N_3 * internal->dim_N_4;
  internal->dim_N_12345 = internal->dim_N_1 * internal->dim_N_2 * internal->dim_N_3 * internal->dim_N_4 * internal->dim_N_5;
  internal->dim_N_123456 = internal->dim_N_1 * internal->dim_N_2 * internal->dim_N_3 * internal->dim_N_4 * internal->dim_N_5 * internal->dim_N_6;
  internal->dim_popinitF = internal->dim_popinitF_1 * internal->dim_popinitF_2 * internal->dim_popinitF_3 * internal->dim_popinitF_4 * internal->dim_popinitF_5 * internal->dim_popinitF_6;
  internal->dim_popinitF_12 = internal->dim_popinitF_1 * internal->dim_popinitF_2;
  internal->dim_popinitF_123 = internal->dim_popinitF_1 * internal->dim_popinitF_2 * internal->dim_popinitF_3;
  internal->dim_popinitF_1234 = internal->dim_popinitF_1 * internal->dim_popinitF_2 * internal->dim_popinitF_3 * internal->dim_popinitF_4;
  internal->dim_popinitF_12345 = internal->dim_popinitF_1 * internal->dim_popinitF_2 * internal->dim_popinitF_3 * internal->dim_popinitF_4 * internal->dim_popinitF_5;
  internal->dim_popinitM = internal->dim_popinitM_1 * internal->dim_popinitM_2 * internal->dim_popinitM_3 * internal->dim_popinitM_4 * internal->dim_popinitM_5 * internal->dim_popinitM_6;
  internal->dim_popinitM_12 = internal->dim_popinitM_1 * internal->dim_popinitM_2;
  internal->dim_popinitM_123 = internal->dim_popinitM_1 * internal->dim_popinitM_2 * internal->dim_popinitM_3;
  internal->dim_popinitM_1234 = internal->dim_popinitM_1 * internal->dim_popinitM_2 * internal->dim_popinitM_3 * internal->dim_popinitM_4;
  internal->dim_popinitM_12345 = internal->dim_popinitM_1 * internal->dim_popinitM_2 * internal->dim_popinitM_3 * internal->dim_popinitM_4 * internal->dim_popinitM_5;
  internal->dim_RiskChange = internal->dim_RiskChange_1 * internal->dim_RiskChange_2 * internal->dim_RiskChange_3 * internal->dim_RiskChange_4 * internal->dim_RiskChange_5 * internal->dim_RiskChange_6 * internal->dim_RiskChange_7;
  internal->dim_RiskChange_12 = internal->dim_RiskChange_1 * internal->dim_RiskChange_2;
  internal->dim_RiskChange_123 = internal->dim_RiskChange_1 * internal->dim_RiskChange_2 * internal->dim_RiskChange_3;
  internal->dim_RiskChange_1234 = internal->dim_RiskChange_1 * internal->dim_RiskChange_2 * internal->dim_RiskChange_3 * internal->dim_RiskChange_4;
  internal->dim_RiskChange_12345 = internal->dim_RiskChange_1 * internal->dim_RiskChange_2 * internal->dim_RiskChange_3 * internal->dim_RiskChange_4 * internal->dim_RiskChange_5;
  internal->dim_RiskChange_123456 = internal->dim_RiskChange_1 * internal->dim_RiskChange_2 * internal->dim_RiskChange_3 * internal->dim_RiskChange_4 * internal->dim_RiskChange_5 * internal->dim_RiskChange_6;
  internal->dim_RiskHazard = internal->dim_RiskHazard_1 * internal->dim_RiskHazard_2 * internal->dim_RiskHazard_3;
  internal->dim_RiskHazard_12 = internal->dim_RiskHazard_1 * internal->dim_RiskHazard_2;
  internal->dim_tbbottom = internal->dim_tbbottom_1 * internal->dim_tbbottom_2 * internal->dim_tbbottom_3;
  internal->dim_tbbottom_12 = internal->dim_tbbottom_1 * internal->dim_tbbottom_2;
  internal->lttp = internal->dim_ttp;
  internal->migrage = (double*) user_get_array(user, false, internal->migrage, "migrage", NA_REAL, NA_REAL, 1, internal->dim_migrage);
  internal->PmigrF_post = (double*) user_get_array(user, false, internal->PmigrF_post, "PmigrF_post", NA_REAL, NA_REAL, 1, internal->dim_PmigrF_post);
  internal->PmigrF_prot = (double*) user_get_array(user, false, internal->PmigrF_prot, "PmigrF_prot", NA_REAL, NA_REAL, 1, internal->dim_PmigrF_prot);
  internal->PmigrF_risk = (double*) user_get_array(user, false, internal->PmigrF_risk, "PmigrF_risk", NA_REAL, NA_REAL, 1, internal->dim_PmigrF_risk);
  internal->PmigrF_strain = (double*) user_get_array(user, false, internal->PmigrF_strain, "PmigrF_strain", NA_REAL, NA_REAL, 1, internal->dim_PmigrF_strain);
  internal->PmigrM_post = (double*) user_get_array(user, false, internal->PmigrM_post, "PmigrM_post", NA_REAL, NA_REAL, 1, internal->dim_PmigrM_post);
  internal->PmigrM_prot = (double*) user_get_array(user, false, internal->PmigrM_prot, "PmigrM_prot", NA_REAL, NA_REAL, 1, internal->dim_PmigrM_prot);
  internal->PmigrM_risk = (double*) user_get_array(user, false, internal->PmigrM_risk, "PmigrM_risk", NA_REAL, NA_REAL, 1, internal->dim_PmigrM_risk);
  internal->PmigrM_strain = (double*) user_get_array(user, false, internal->PmigrM_strain, "PmigrM_strain", NA_REAL, NA_REAL, 1, internal->dim_PmigrM_strain);
  internal->r = (double*) user_get_array(user, false, internal->r, "r", NA_REAL, NA_REAL, 1, internal->dim_r);
  R_Free(internal->initial_N);
  internal->initial_N = (double*) R_Calloc(internal->dim_N, double);
  R_Free(internal->migrF);
  internal->migrF = (double*) R_Calloc(internal->dim_migrF, double);
  R_Free(internal->migrFagein);
  internal->migrFagein = (double*) R_Calloc(internal->dim_migrFagein, double);
  R_Free(internal->migrFageout);
  internal->migrFageout = (double*) R_Calloc(internal->dim_migrFageout, double);
  R_Free(internal->migrM);
  internal->migrM = (double*) R_Calloc(internal->dim_migrM, double);
  R_Free(internal->migrMagein);
  internal->migrMagein = (double*) R_Calloc(internal->dim_migrMagein, double);
  R_Free(internal->migrMageout);
  internal->migrMageout = (double*) R_Calloc(internal->dim_migrMageout, double);
  R_Free(internal->RiskChange);
  internal->RiskChange = (double*) R_Calloc(internal->dim_RiskChange, double);
  R_Free(internal->RiskHazard);
  internal->RiskHazard = (double*) R_Calloc(internal->dim_RiskHazard, double);
  R_Free(internal->tbbottom);
  internal->tbbottom = (double*) R_Calloc(internal->dim_tbbottom, double);
  internal->dim_BF = internal->lttp;
  internal->dim_BM = internal->lttp;
  internal->dim_immigration_female_1 = internal->lttp;
  internal->dim_immigration_female_2 = internal->nage;
  internal->dim_immigration_male_1 = internal->lttp;
  internal->dim_immigration_male_2 = internal->nage;
  internal->dim_popdatF_1 = internal->lttp;
  internal->dim_popdatF_2 = internal->nage;
  internal->dim_popdatM_1 = internal->lttp;
  internal->dim_popdatM_2 = internal->nage;
  internal->dim_RiskHazardData_1 = internal->lttp;
  internal->dim_RiskHazardData_2 = internal->nage;
  internal->dim_RiskHazardData_3 = 2;
  internal->dim_RiskHazardData_4 = internal->nrisk;
  {
     int i = 1;
     internal->native[i - 1] = 1;
  }
  for (int i = 2; i <= internal->nnat; ++i) {
    internal->native[i - 1] = 0;
  }
  for (int i = 1; i <= internal->nnat; ++i) {
    internal->Pmigr_nat[i - 1] = (i == 2 ? 1 : 0);
  }
  internal->popinitF = (double*) user_get_array(user, false, internal->popinitF, "popinitF", NA_REAL, NA_REAL, 6, internal->dim_popinitF_1, internal->dim_popinitF_2, internal->dim_popinitF_3, internal->dim_popinitF_4, internal->dim_popinitF_5, internal->dim_popinitF_6);
  internal->popinitM = (double*) user_get_array(user, false, internal->popinitM, "popinitM", NA_REAL, NA_REAL, 6, internal->dim_popinitM_1, internal->dim_popinitM_2, internal->dim_popinitM_3, internal->dim_popinitM_4, internal->dim_popinitM_5, internal->dim_popinitM_6);
  internal->BF = (double*) user_get_array(user, false, internal->BF, "BF", NA_REAL, NA_REAL, 1, internal->dim_BF);
  internal->BM = (double*) user_get_array(user, false, internal->BM, "BM", NA_REAL, NA_REAL, 1, internal->dim_BM);
  internal->dim_immigration_female = internal->dim_immigration_female_1 * internal->dim_immigration_female_2;
  internal->dim_immigration_male = internal->dim_immigration_male_1 * internal->dim_immigration_male_2;
  internal->dim_popdatF = internal->dim_popdatF_1 * internal->dim_popdatF_2;
  internal->dim_popdatM = internal->dim_popdatM_1 * internal->dim_popdatM_2;
  internal->dim_RiskHazardData = internal->dim_RiskHazardData_1 * internal->dim_RiskHazardData_2 * internal->dim_RiskHazardData_3 * internal->dim_RiskHazardData_4;
  internal->dim_RiskHazardData_12 = internal->dim_RiskHazardData_1 * internal->dim_RiskHazardData_2;
  internal->dim_RiskHazardData_123 = internal->dim_RiskHazardData_1 * internal->dim_RiskHazardData_2 * internal->dim_RiskHazardData_3;
  for (int i = 1; i <= internal->nage; ++i) {
    int j = 1;
    for (int k = 1; k <= internal->nnat; ++k) {
      for (int l = 1; l <= internal->nrisk; ++l) {
        for (int i5 = 1; i5 <= internal->npost; ++i5) {
          for (int i6 = 1; i6 <= internal->nstrain; ++i6) {
            for (int i7 = 1; i7 <= internal->nprot; ++i7) {
              internal->initial_N[i - 1 + internal->dim_N_1 * (j - 1) + internal->dim_N_12 * (k - 1) + internal->dim_N_123 * (l - 1) + internal->dim_N_1234 * (i5 - 1) + internal->dim_N_12345 * (i6 - 1) + internal->dim_N_123456 * (i7 - 1)] = internal->popinitM[internal->dim_popinitM_12345 * (i7 - 1) + internal->dim_popinitM_1234 * (i6 - 1) + internal->dim_popinitM_123 * (i5 - 1) + internal->dim_popinitM_12 * (l - 1) + internal->dim_popinitM_1 * (k - 1) + i - 1];
            }
          }
        }
      }
    }
  }
  for (int i = 1; i <= internal->nage; ++i) {
    int j = 2;
    for (int k = 1; k <= internal->nnat; ++k) {
      for (int l = 1; l <= internal->nrisk; ++l) {
        for (int i5 = 1; i5 <= internal->npost; ++i5) {
          for (int i6 = 1; i6 <= internal->nstrain; ++i6) {
            for (int i7 = 1; i7 <= internal->nprot; ++i7) {
              internal->initial_N[i - 1 + internal->dim_N_1 * (j - 1) + internal->dim_N_12 * (k - 1) + internal->dim_N_123 * (l - 1) + internal->dim_N_1234 * (i5 - 1) + internal->dim_N_12345 * (i6 - 1) + internal->dim_N_123456 * (i7 - 1)] = internal->popinitF[internal->dim_popinitF_12345 * (i7 - 1) + internal->dim_popinitF_1234 * (i6 - 1) + internal->dim_popinitF_123 * (i5 - 1) + internal->dim_popinitF_12 * (l - 1) + internal->dim_popinitF_1 * (k - 1) + i - 1];
            }
          }
        }
      }
    }
  }
  for (int i = 1; i <= internal->npost; ++i) {
    for (int j = 1; j <= internal->nstrain; ++j) {
      for (int k = 1; k <= internal->nprot; ++k) {
        internal->tbbottom[i - 1 + internal->dim_tbbottom_1 * (j - 1) + internal->dim_tbbottom_12 * (k - 1)] = 0;
      }
    }
  }
  {
     int i = 1;
     int j = 1;
     int k = 1;
     internal->tbbottom[i - 1 + internal->dim_tbbottom_1 * (j - 1) + internal->dim_tbbottom_12 * (k - 1)] = 1;
  }
  internal->immigration_female = (double*) user_get_array(user, false, internal->immigration_female, "immigration_female", NA_REAL, NA_REAL, 2, internal->dim_immigration_female_1, internal->dim_immigration_female_2);
  internal->immigration_male = (double*) user_get_array(user, false, internal->immigration_male, "immigration_male", NA_REAL, NA_REAL, 2, internal->dim_immigration_male_1, internal->dim_immigration_male_2);
  interpolate_check_y(internal->dim_ttp, internal->dim_BF, 0, "BF", "bzf");
  cinterpolate_free(internal->interpolate_bzf);
  internal->interpolate_bzf = cinterpolate_alloc("linear", internal->dim_ttp, 1, internal->ttp, internal->BF, true, false);
  interpolate_check_y(internal->dim_ttp, internal->dim_BM, 0, "BM", "bzm");
  cinterpolate_free(internal->interpolate_bzm);
  internal->interpolate_bzm = cinterpolate_alloc("linear", internal->dim_ttp, 1, internal->ttp, internal->BM, true, false);
  internal->popdatF = (double*) user_get_array(user, false, internal->popdatF, "popdatF", NA_REAL, NA_REAL, 2, internal->dim_popdatF_1, internal->dim_popdatF_2);
  internal->popdatM = (double*) user_get_array(user, false, internal->popdatM, "popdatM", NA_REAL, NA_REAL, 2, internal->dim_popdatM_1, internal->dim_popdatM_2);
  internal->RiskHazardData = (double*) user_get_array(user, false, internal->RiskHazardData, "RiskHazardData", NA_REAL, NA_REAL, 4, internal->dim_RiskHazardData_1, internal->dim_RiskHazardData_2, internal->dim_RiskHazardData_3, internal->dim_RiskHazardData_4);
  interpolate_check_y(internal->dim_ttp, internal->dim_immigration_female_1, 1, "immigration_female", "InF");
  interpolate_check_y(internal->dim_InF, internal->dim_immigration_female_2, 2, "immigration_female", "InF");
  cinterpolate_free(internal->interpolate_InF);
  internal->interpolate_InF = cinterpolate_alloc("linear", internal->dim_ttp, internal->dim_InF, internal->ttp, internal->immigration_female, true, false);
  interpolate_check_y(internal->dim_ttp, internal->dim_immigration_male_1, 1, "immigration_male", "InM");
  interpolate_check_y(internal->dim_InM, internal->dim_immigration_male_2, 2, "immigration_male", "InM");
  cinterpolate_free(internal->interpolate_InM);
  internal->interpolate_InM = cinterpolate_alloc("linear", internal->dim_ttp, internal->dim_InM, internal->ttp, internal->immigration_male, true, false);
  interpolate_check_y(internal->dim_ttp, internal->dim_popdatF_1, 1, "popdatF", "omegaF");
  interpolate_check_y(internal->dim_omegaF, internal->dim_popdatF_2, 2, "popdatF", "omegaF");
  cinterpolate_free(internal->interpolate_omegaF);
  internal->interpolate_omegaF = cinterpolate_alloc("linear", internal->dim_ttp, internal->dim_omegaF, internal->ttp, internal->popdatF, true, false);
  interpolate_check_y(internal->dim_ttp, internal->dim_popdatM_1, 1, "popdatM", "omegaM");
  interpolate_check_y(internal->dim_omegaM, internal->dim_popdatM_2, 2, "popdatM", "omegaM");
  cinterpolate_free(internal->interpolate_omegaM);
  internal->interpolate_omegaM = cinterpolate_alloc("linear", internal->dim_ttp, internal->dim_omegaM, internal->ttp, internal->popdatM, true, false);
  interpolate_check_y(internal->dim_ttp, internal->dim_RiskHazardData_1, 1, "RiskHazardData", "RiskHazard");
  interpolate_check_y(internal->dim_RiskHazard_1, internal->dim_RiskHazardData_2, 2, "RiskHazardData", "RiskHazard");
  interpolate_check_y(internal->dim_RiskHazard_2, internal->dim_RiskHazardData_3, 3, "RiskHazardData", "RiskHazard");
  interpolate_check_y(internal->dim_RiskHazard_3, internal->dim_RiskHazardData_4, 4, "RiskHazardData", "RiskHazard");
  cinterpolate_free(internal->interpolate_RiskHazard);
  internal->interpolate_RiskHazard = cinterpolate_alloc("linear", internal->dim_ttp, internal->dim_RiskHazard, internal->ttp, internal->RiskHazardData, true, false);
  return R_NilValue;
}
SEXP ocaode_set_initial(SEXP internal_p, SEXP t_ptr, SEXP state_ptr, SEXP ocaode_use_dde_ptr) {
  return R_NilValue;
}
SEXP ocaode_metadata(SEXP internal_p) {
  ocaode_internal *internal = ocaode_get_internal(internal_p, 1);
  SEXP ret = PROTECT(allocVector(VECSXP, 4));
  SEXP nms = PROTECT(allocVector(STRSXP, 4));
  SET_STRING_ELT(nms, 0, mkChar("variable_order"));
  SET_STRING_ELT(nms, 1, mkChar("output_order"));
  SET_STRING_ELT(nms, 2, mkChar("n_out"));
  SET_STRING_ELT(nms, 3, mkChar("interpolate_t"));
  setAttrib(ret, R_NamesSymbol, nms);
  SEXP variable_length = PROTECT(allocVector(VECSXP, 1));
  SEXP variable_names = PROTECT(allocVector(STRSXP, 1));
  setAttrib(variable_length, R_NamesSymbol, variable_names);
  SET_VECTOR_ELT(variable_length, 0, allocVector(INTSXP, 7));
  int * dim_N = INTEGER(VECTOR_ELT(variable_length, 0));
  dim_N[0] = internal->dim_N_1;
  dim_N[1] = internal->dim_N_2;
  dim_N[2] = internal->dim_N_3;
  dim_N[3] = internal->dim_N_4;
  dim_N[4] = internal->dim_N_5;
  dim_N[5] = internal->dim_N_6;
  dim_N[6] = internal->dim_N_7;
  SET_STRING_ELT(variable_names, 0, mkChar("N"));
  SET_VECTOR_ELT(ret, 0, variable_length);
  UNPROTECT(2);
  SET_VECTOR_ELT(ret, 1, R_NilValue);
  SET_VECTOR_ELT(ret, 2, ScalarInteger(0));
  SEXP interpolate_t = PROTECT(allocVector(VECSXP, 3));
  SEXP interpolate_t_nms = PROTECT(allocVector(STRSXP, 3));
  setAttrib(interpolate_t, R_NamesSymbol, interpolate_t_nms);
  SET_VECTOR_ELT(interpolate_t, 0, ScalarReal(internal->ttp[0]));
  SET_VECTOR_ELT(interpolate_t, 1, ScalarReal(internal->ttp[internal->dim_ttp - 1]));
  SET_STRING_ELT(interpolate_t_nms, 0, mkChar("min"));
  SET_STRING_ELT(interpolate_t_nms, 1, mkChar("max"));
  SET_VECTOR_ELT(ret, 3, interpolate_t);
  UNPROTECT(2);
  UNPROTECT(2);
  return ret;
}
SEXP ocaode_initial_conditions(SEXP internal_p, SEXP t_ptr) {
  ocaode_internal *internal = ocaode_get_internal(internal_p, 1);
  SEXP r_state = PROTECT(allocVector(REALSXP, internal->dim_N));
  double * state = REAL(r_state);
  memcpy(state + 0, internal->initial_N, internal->dim_N * sizeof(double));
  UNPROTECT(1);
  return r_state;
}
void ocaode_rhs(ocaode_internal* internal, double t, double * state, double * dstatedt, double * output) {
  double * N = state + 0;
  for (int i = 1; i <= internal->nage; ++i) {
    for (int j = 1; j <= internal->nnat; ++j) {
      for (int k = 1; k <= internal->nrisk; ++k) {
        for (int l = 1; l <= internal->npost; ++l) {
          for (int i5 = 1; i5 <= internal->nstrain; ++i5) {
            for (int i6 = 1; i6 <= internal->nprot; ++i6) {
              internal->migrFagein[i - 1 + internal->dim_migrFagein_1 * (j - 1) + internal->dim_migrFagein_12 * (k - 1) + internal->dim_migrFagein_123 * (l - 1) + internal->dim_migrFagein_1234 * (i5 - 1) + internal->dim_migrFagein_12345 * (i6 - 1)] = (j > 2 ? N[internal->dim_N_123456 * (i6 - 1) + internal->dim_N_12345 * (i5 - 1) + internal->dim_N_1234 * (l - 1) + internal->dim_N_123 * (k - 1) + internal->dim_N_12 * (j - 1 - 1) + internal->dim_N_1 * 1 + i - 1] * internal->migrage[j - 1 - 1] : 0);
            }
          }
        }
      }
    }
  }
  for (int i = 1; i <= internal->nage; ++i) {
    for (int j = 1; j <= internal->nnat; ++j) {
      for (int k = 1; k <= internal->nrisk; ++k) {
        for (int l = 1; l <= internal->npost; ++l) {
          for (int i5 = 1; i5 <= internal->nstrain; ++i5) {
            for (int i6 = 1; i6 <= internal->nprot; ++i6) {
              internal->migrFageout[i - 1 + internal->dim_migrFageout_1 * (j - 1) + internal->dim_migrFageout_12 * (k - 1) + internal->dim_migrFageout_123 * (l - 1) + internal->dim_migrFageout_1234 * (i5 - 1) + internal->dim_migrFageout_12345 * (i6 - 1)] = (j > 1 && j < internal->nnat ? N[internal->dim_N_123456 * (i6 - 1) + internal->dim_N_12345 * (i5 - 1) + internal->dim_N_1234 * (l - 1) + internal->dim_N_123 * (k - 1) + internal->dim_N_12 * (j - 1) + internal->dim_N_1 * 1 + i - 1] * internal->migrage[j - 1] : 0);
            }
          }
        }
      }
    }
  }
  for (int i = 1; i <= internal->nage; ++i) {
    for (int j = 1; j <= internal->nnat; ++j) {
      for (int k = 1; k <= internal->nrisk; ++k) {
        for (int l = 1; l <= internal->npost; ++l) {
          for (int i5 = 1; i5 <= internal->nstrain; ++i5) {
            for (int i6 = 1; i6 <= internal->nprot; ++i6) {
              internal->migrMagein[i - 1 + internal->dim_migrMagein_1 * (j - 1) + internal->dim_migrMagein_12 * (k - 1) + internal->dim_migrMagein_123 * (l - 1) + internal->dim_migrMagein_1234 * (i5 - 1) + internal->dim_migrMagein_12345 * (i6 - 1)] = (j > 2 ? N[internal->dim_N_123456 * (i6 - 1) + internal->dim_N_12345 * (i5 - 1) + internal->dim_N_1234 * (l - 1) + internal->dim_N_123 * (k - 1) + internal->dim_N_12 * (j - 1 - 1) + internal->dim_N_1 * 0 + i - 1] * internal->migrage[j - 1 - 1] : 0);
            }
          }
        }
      }
    }
  }
  for (int i = 1; i <= internal->nage; ++i) {
    for (int j = 1; j <= internal->nnat; ++j) {
      for (int k = 1; k <= internal->nrisk; ++k) {
        for (int l = 1; l <= internal->npost; ++l) {
          for (int i5 = 1; i5 <= internal->nstrain; ++i5) {
            for (int i6 = 1; i6 <= internal->nprot; ++i6) {
              internal->migrMageout[i - 1 + internal->dim_migrMageout_1 * (j - 1) + internal->dim_migrMageout_12 * (k - 1) + internal->dim_migrMageout_123 * (l - 1) + internal->dim_migrMageout_1234 * (i5 - 1) + internal->dim_migrMageout_12345 * (i6 - 1)] = (j > 1 && j < internal->nnat ? N[internal->dim_N_123456 * (i6 - 1) + internal->dim_N_12345 * (i5 - 1) + internal->dim_N_1234 * (l - 1) + internal->dim_N_123 * (k - 1) + internal->dim_N_12 * (j - 1) + internal->dim_N_1 * 0 + i - 1] * internal->migrage[j - 1] : 0);
            }
          }
        }
      }
    }
  }
  double bzf = 0.0;
  cinterpolate_eval(t, internal->interpolate_bzf, &bzf);
  double bzm = 0.0;
  cinterpolate_eval(t, internal->interpolate_bzm, &bzm);
  cinterpolate_eval(t, internal->interpolate_InF, internal->InF);
  cinterpolate_eval(t, internal->interpolate_InM, internal->InM);
  cinterpolate_eval(t, internal->interpolate_omegaF, internal->omegaF);
  cinterpolate_eval(t, internal->interpolate_omegaM, internal->omegaM);
  cinterpolate_eval(t, internal->interpolate_RiskHazard, internal->RiskHazard);
  for (int i = 1; i <= internal->nage; ++i) {
    for (int j = 1; j <= internal->nnat; ++j) {
      for (int k = 1; k <= internal->nrisk; ++k) {
        for (int l = 1; l <= internal->npost; ++l) {
          for (int i5 = 1; i5 <= internal->nstrain; ++i5) {
            for (int i6 = 1; i6 <= internal->nprot; ++i6) {
              internal->migrF[i - 1 + internal->dim_migrF_1 * (j - 1) + internal->dim_migrF_12 * (k - 1) + internal->dim_migrF_123 * (l - 1) + internal->dim_migrF_1234 * (i5 - 1) + internal->dim_migrF_12345 * (i6 - 1)] = internal->InF[i - 1] * internal->Pmigr_nat[j - 1] * internal->PmigrF_risk[k - 1] * internal->PmigrF_post[l - 1] * internal->PmigrF_strain[i5 - 1] * internal->PmigrF_prot[i6 - 1];
            }
          }
        }
      }
    }
  }
  for (int i = 1; i <= internal->nage; ++i) {
    for (int j = 1; j <= internal->nnat; ++j) {
      for (int k = 1; k <= internal->nrisk; ++k) {
        for (int l = 1; l <= internal->npost; ++l) {
          for (int i5 = 1; i5 <= internal->nstrain; ++i5) {
            for (int i6 = 1; i6 <= internal->nprot; ++i6) {
              internal->migrM[i - 1 + internal->dim_migrM_1 * (j - 1) + internal->dim_migrM_12 * (k - 1) + internal->dim_migrM_123 * (l - 1) + internal->dim_migrM_1234 * (i5 - 1) + internal->dim_migrM_12345 * (i6 - 1)] = internal->InM[i - 1] * internal->Pmigr_nat[j - 1] * internal->PmigrM_risk[k - 1] * internal->PmigrM_post[l - 1] * internal->PmigrM_strain[i5 - 1] * internal->PmigrM_prot[i6 - 1];
            }
          }
        }
      }
    }
  }
  for (int i = 1; i <= internal->nage; ++i) {
    for (int j = 1; j <= 2; ++j) {
      for (int k = 1; k <= internal->nnat; ++k) {
        for (int l = 1; l <= internal->nrisk; ++l) {
          for (int i5 = 1; i5 <= internal->npost; ++i5) {
            for (int i6 = 1; i6 <= internal->nstrain; ++i6) {
              for (int i7 = 1; i7 <= internal->nprot; ++i7) {
                internal->RiskChange[i - 1 + internal->dim_RiskChange_1 * (j - 1) + internal->dim_RiskChange_12 * (k - 1) + internal->dim_RiskChange_123 * (l - 1) + internal->dim_RiskChange_1234 * (i5 - 1) + internal->dim_RiskChange_12345 * (i6 - 1) + internal->dim_RiskChange_123456 * (i7 - 1)] = (l > 1 ? internal->RiskHazard[internal->dim_RiskHazard_12 * (l - 1 - 1) + internal->dim_RiskHazard_1 * (j - 1) + i - 1] * N[internal->dim_N_123456 * (i7 - 1) + internal->dim_N_12345 * (i6 - 1) + internal->dim_N_1234 * (i5 - 1) + internal->dim_N_123 * (l - 1 - 1) + internal->dim_N_12 * (k - 1) + internal->dim_N_1 * (j - 1) + i - 1] - internal->RiskHazard[internal->dim_RiskHazard_12 * (l - 1) + internal->dim_RiskHazard_1 * (j - 1) + i - 1] * N[internal->dim_N_123456 * (i7 - 1) + internal->dim_N_12345 * (i6 - 1) + internal->dim_N_1234 * (i5 - 1) + internal->dim_N_123 * (l - 1) + internal->dim_N_12 * (k - 1) + internal->dim_N_1 * (j - 1) + i - 1] : -(internal->RiskHazard[internal->dim_RiskHazard_12 * (l - 1) + internal->dim_RiskHazard_1 * (j - 1) + i - 1]) * N[internal->dim_N_123456 * (i7 - 1) + internal->dim_N_12345 * (i6 - 1) + internal->dim_N_1234 * (i5 - 1) + internal->dim_N_123 * (l - 1) + internal->dim_N_12 * (k - 1) + internal->dim_N_1 * (j - 1) + i - 1]);
              }
            }
          }
        }
      }
    }
  }
  {
     int i = 1;
     int j = 1;
     for (int k = 1; k <= internal->nnat; ++k) {
       for (int l = 1; l <= internal->nrisk; ++l) {
         for (int i5 = 1; i5 <= internal->npost; ++i5) {
           for (int i6 = 1; i6 <= internal->nstrain; ++i6) {
             for (int i7 = 1; i7 <= internal->nprot; ++i7) {
               dstatedt[0 + i - 1 + internal->dim_N_1 * (j - 1) + internal->dim_N_12 * (k - 1) + internal->dim_N_123 * (l - 1) + internal->dim_N_1234 * (i5 - 1) + internal->dim_N_12345 * (i6 - 1) + internal->dim_N_123456 * (i7 - 1)] = bzm * internal->native[k - 1] * internal->birthrisk[l - 1] * internal->tbbottom[internal->dim_tbbottom_12 * (i7 - 1) + internal->dim_tbbottom_1 * (i6 - 1) + i5 - 1] - internal->omegaM[0] * N[internal->dim_N_123456 * (i7 - 1) + internal->dim_N_12345 * (i6 - 1) + internal->dim_N_1234 * (i5 - 1) + internal->dim_N_123 * (l - 1) + internal->dim_N_12 * (k - 1) + internal->dim_N_1 * 0 + 0] + internal->migrM[internal->dim_migrM_12345 * (i7 - 1) + internal->dim_migrM_1234 * (i6 - 1) + internal->dim_migrM_123 * (i5 - 1) + internal->dim_migrM_12 * (l - 1) + internal->dim_migrM_1 * (k - 1) + 0] + internal->migrMagein[internal->dim_migrMagein_12345 * (i7 - 1) + internal->dim_migrMagein_1234 * (i6 - 1) + internal->dim_migrMagein_123 * (i5 - 1) + internal->dim_migrMagein_12 * (l - 1) + internal->dim_migrMagein_1 * (k - 1) + 0] - internal->migrMageout[internal->dim_migrMageout_12345 * (i7 - 1) + internal->dim_migrMageout_1234 * (i6 - 1) + internal->dim_migrMageout_123 * (i5 - 1) + internal->dim_migrMageout_12 * (l - 1) + internal->dim_migrMageout_1 * (k - 1) + 0];
             }
           }
         }
       }
     }
  }
  for (int i = 2; i <= internal->nage; ++i) {
    int j = 1;
    for (int k = 1; k <= internal->nnat; ++k) {
      for (int l = 1; l <= internal->nrisk; ++l) {
        for (int i5 = 1; i5 <= internal->npost; ++i5) {
          for (int i6 = 1; i6 <= internal->nstrain; ++i6) {
            for (int i7 = 1; i7 <= internal->nprot; ++i7) {
              dstatedt[0 + i - 1 + internal->dim_N_1 * (j - 1) + internal->dim_N_12 * (k - 1) + internal->dim_N_123 * (l - 1) + internal->dim_N_1234 * (i5 - 1) + internal->dim_N_12345 * (i6 - 1) + internal->dim_N_123456 * (i7 - 1)] = internal->r[i - 1 - 1] * N[internal->dim_N_123456 * (i7 - 1) + internal->dim_N_12345 * (i6 - 1) + internal->dim_N_1234 * (i5 - 1) + internal->dim_N_123 * (l - 1) + internal->dim_N_12 * (k - 1) + internal->dim_N_1 * 0 + i - 1 - 1] - internal->omegaM[i - 1] * N[internal->dim_N_123456 * (i7 - 1) + internal->dim_N_12345 * (i6 - 1) + internal->dim_N_1234 * (i5 - 1) + internal->dim_N_123 * (l - 1) + internal->dim_N_12 * (k - 1) + internal->dim_N_1 * 0 + i - 1] + internal->migrM[internal->dim_migrM_12345 * (i7 - 1) + internal->dim_migrM_1234 * (i6 - 1) + internal->dim_migrM_123 * (i5 - 1) + internal->dim_migrM_12 * (l - 1) + internal->dim_migrM_1 * (k - 1) + i - 1] + internal->migrMagein[internal->dim_migrMagein_12345 * (i7 - 1) + internal->dim_migrMagein_1234 * (i6 - 1) + internal->dim_migrMagein_123 * (i5 - 1) + internal->dim_migrMagein_12 * (l - 1) + internal->dim_migrMagein_1 * (k - 1) + i - 1] - internal->migrMageout[internal->dim_migrMageout_12345 * (i7 - 1) + internal->dim_migrMageout_1234 * (i6 - 1) + internal->dim_migrMageout_123 * (i5 - 1) + internal->dim_migrMageout_12 * (l - 1) + internal->dim_migrMageout_1 * (k - 1) + i - 1] + internal->RiskChange[internal->dim_RiskChange_123456 * (i7 - 1) + internal->dim_RiskChange_12345 * (i6 - 1) + internal->dim_RiskChange_1234 * (i5 - 1) + internal->dim_RiskChange_123 * (l - 1) + internal->dim_RiskChange_12 * (k - 1) + internal->dim_RiskChange_1 * 0 + i - 1];
            }
          }
        }
      }
    }
  }
  {
     int i = 1;
     int j = 2;
     for (int k = 1; k <= internal->nnat; ++k) {
       for (int l = 1; l <= internal->nrisk; ++l) {
         for (int i5 = 1; i5 <= internal->npost; ++i5) {
           for (int i6 = 1; i6 <= internal->nstrain; ++i6) {
             for (int i7 = 1; i7 <= internal->nprot; ++i7) {
               dstatedt[0 + i - 1 + internal->dim_N_1 * (j - 1) + internal->dim_N_12 * (k - 1) + internal->dim_N_123 * (l - 1) + internal->dim_N_1234 * (i5 - 1) + internal->dim_N_12345 * (i6 - 1) + internal->dim_N_123456 * (i7 - 1)] = bzf * internal->native[k - 1] * internal->birthrisk[l - 1] * internal->tbbottom[internal->dim_tbbottom_12 * (i7 - 1) + internal->dim_tbbottom_1 * (i6 - 1) + i5 - 1] - internal->omegaF[0] * N[internal->dim_N_123456 * (i7 - 1) + internal->dim_N_12345 * (i6 - 1) + internal->dim_N_1234 * (i5 - 1) + internal->dim_N_123 * (l - 1) + internal->dim_N_12 * (k - 1) + internal->dim_N_1 * 1 + 0] + internal->migrF[internal->dim_migrF_12345 * (i7 - 1) + internal->dim_migrF_1234 * (i6 - 1) + internal->dim_migrF_123 * (i5 - 1) + internal->dim_migrF_12 * (l - 1) + internal->dim_migrF_1 * (k - 1) + 0] + internal->migrFagein[internal->dim_migrFagein_12345 * (i7 - 1) + internal->dim_migrFagein_1234 * (i6 - 1) + internal->dim_migrFagein_123 * (i5 - 1) + internal->dim_migrFagein_12 * (l - 1) + internal->dim_migrFagein_1 * (k - 1) + 0] - internal->migrFageout[internal->dim_migrFageout_12345 * (i7 - 1) + internal->dim_migrFageout_1234 * (i6 - 1) + internal->dim_migrFageout_123 * (i5 - 1) + internal->dim_migrFageout_12 * (l - 1) + internal->dim_migrFageout_1 * (k - 1) + 0];
             }
           }
         }
       }
     }
  }
  for (int i = 2; i <= internal->nage; ++i) {
    int j = 2;
    for (int k = 1; k <= internal->nnat; ++k) {
      for (int l = 1; l <= internal->nrisk; ++l) {
        for (int i5 = 1; i5 <= internal->npost; ++i5) {
          for (int i6 = 1; i6 <= internal->nstrain; ++i6) {
            for (int i7 = 1; i7 <= internal->nprot; ++i7) {
              dstatedt[0 + i - 1 + internal->dim_N_1 * (j - 1) + internal->dim_N_12 * (k - 1) + internal->dim_N_123 * (l - 1) + internal->dim_N_1234 * (i5 - 1) + internal->dim_N_12345 * (i6 - 1) + internal->dim_N_123456 * (i7 - 1)] = internal->r[i - 1 - 1] * N[internal->dim_N_123456 * (i7 - 1) + internal->dim_N_12345 * (i6 - 1) + internal->dim_N_1234 * (i5 - 1) + internal->dim_N_123 * (l - 1) + internal->dim_N_12 * (k - 1) + internal->dim_N_1 * 1 + i - 1 - 1] - internal->omegaF[i - 1] * N[internal->dim_N_123456 * (i7 - 1) + internal->dim_N_12345 * (i6 - 1) + internal->dim_N_1234 * (i5 - 1) + internal->dim_N_123 * (l - 1) + internal->dim_N_12 * (k - 1) + internal->dim_N_1 * 1 + i - 1] + internal->migrF[internal->dim_migrF_12345 * (i7 - 1) + internal->dim_migrF_1234 * (i6 - 1) + internal->dim_migrF_123 * (i5 - 1) + internal->dim_migrF_12 * (l - 1) + internal->dim_migrF_1 * (k - 1) + i - 1] + internal->migrFagein[internal->dim_migrFagein_12345 * (i7 - 1) + internal->dim_migrFagein_1234 * (i6 - 1) + internal->dim_migrFagein_123 * (i5 - 1) + internal->dim_migrFagein_12 * (l - 1) + internal->dim_migrFagein_1 * (k - 1) + i - 1] - internal->migrFageout[internal->dim_migrFageout_12345 * (i7 - 1) + internal->dim_migrFageout_1234 * (i6 - 1) + internal->dim_migrFageout_123 * (i5 - 1) + internal->dim_migrFageout_12 * (l - 1) + internal->dim_migrFageout_1 * (k - 1) + i - 1] + internal->RiskChange[internal->dim_RiskChange_123456 * (i7 - 1) + internal->dim_RiskChange_12345 * (i6 - 1) + internal->dim_RiskChange_1234 * (i5 - 1) + internal->dim_RiskChange_123 * (l - 1) + internal->dim_RiskChange_12 * (k - 1) + internal->dim_RiskChange_1 * 1 + i - 1];
            }
          }
        }
      }
    }
  }
}
void ocaode_rhs_dde(size_t neq, double t, double * state, double * dstatedt, void * internal) {
  ocaode_rhs((ocaode_internal*)internal, t, state, dstatedt, NULL);
}
void ocaode_rhs_desolve(int * neq, double * t, double * state, double * dstatedt, double * output, int * np) {
  ocaode_rhs(ocaode_internal_ds, *t, state, dstatedt, output);
}
SEXP ocaode_rhs_r(SEXP internal_p, SEXP t, SEXP state) {
  SEXP dstatedt = PROTECT(allocVector(REALSXP, LENGTH(state)));
  ocaode_internal *internal = ocaode_get_internal(internal_p, 1);
  double *output = NULL;
  ocaode_rhs(internal, scalar_real(t, "t"), REAL(state), REAL(dstatedt), output);
  UNPROTECT(1);
  return dstatedt;
}
double user_get_scalar_double(SEXP user, const char *name,
                              double default_value, double min, double max) {
  double ret = default_value;
  SEXP el = user_list_element(user, name);
  if (el != R_NilValue) {
    if (length(el) != 1) {
      Rf_error("Expected a scalar numeric for '%s'", name);
    }
    if (TYPEOF(el) == REALSXP) {
      ret = REAL(el)[0];
    } else if (TYPEOF(el) == INTSXP) {
      ret = INTEGER(el)[0];
    } else {
      Rf_error("Expected a numeric value for '%s'", name);
    }
  }
  if (ISNA(ret)) {
    Rf_error("Expected a value for '%s'", name);
  }
  user_check_values_double(&ret, 1, min, max, name);
  return ret;
}
int user_get_scalar_int(SEXP user, const char *name,
                        int default_value, double min, double max) {
  int ret = default_value;
  SEXP el = user_list_element(user, name);
  if (el != R_NilValue) {
    if (length(el) != 1) {
      Rf_error("Expected scalar integer for '%s'", name);
    }
    if (TYPEOF(el) == REALSXP) {
      double tmp = REAL(el)[0];
      if (fabs(tmp - round(tmp)) > 2e-8) {
        Rf_error("Expected '%s' to be integer-like", name);
      }
    }
    ret = INTEGER(coerceVector(el, INTSXP))[0];
  }
  if (ret == NA_INTEGER) {
    Rf_error("Expected a value for '%s'", name);
  }
  user_check_values_int(&ret, 1, min, max, name);
  return ret;
}
void user_check_values_double(double * value, size_t len,
                                  double min, double max, const char *name) {
  for (size_t i = 0; i < len; ++i) {
    if (ISNA(value[i])) {
      Rf_error("'%s' must not contain any NA values", name);
    }
  }
  if (min != NA_REAL) {
    for (size_t i = 0; i < len; ++i) {
      if (value[i] < min) {
        Rf_error("Expected '%s' to be at least %g", name, min);
      }
    }
  }
  if (max != NA_REAL) {
    for (size_t i = 0; i < len; ++i) {
      if (value[i] > max) {
        Rf_error("Expected '%s' to be at most %g", name, max);
      }
    }
  }
}
void user_check_values_int(int * value, size_t len,
                               double min, double max, const char *name) {
  for (size_t i = 0; i < len; ++i) {
    if (ISNA(value[i])) {
      Rf_error("'%s' must not contain any NA values", name);
    }
  }
  if (min != NA_REAL) {
    for (size_t i = 0; i < len; ++i) {
      if (value[i] < min) {
        Rf_error("Expected '%s' to be at least %g", name, min);
      }
    }
  }
  if (max != NA_REAL) {
    for (size_t i = 0; i < len; ++i) {
      if (value[i] > max) {
        Rf_error("Expected '%s' to be at most %g", name, max);
      }
    }
  }
}
void user_check_values(SEXP value, double min, double max,
                           const char *name) {
  size_t len = (size_t)length(value);
  if (TYPEOF(value) == INTSXP) {
    user_check_values_int(INTEGER(value), len, min, max, name);
  } else {
    user_check_values_double(REAL(value), len, min, max, name);
  }
}
SEXP user_list_element(SEXP list, const char *name) {
  SEXP ret = R_NilValue, names = getAttrib(list, R_NamesSymbol);
  for (int i = 0; i < length(list); ++i) {
    if (strcmp(CHAR(STRING_ELT(names, i)), name) == 0) {
      ret = VECTOR_ELT(list, i);
      break;
    }
  }
  return ret;
}
void odin_set_dim(SEXP target, int rank, ...) {
  SEXP r_dim = PROTECT(allocVector(INTSXP, rank));
  int *dim = INTEGER(r_dim);

  va_list ap;
  va_start(ap, rank);
  for (size_t i = 0; i < (size_t)rank; ++i) {
    dim[i] = va_arg(ap, int);
  }
  va_end(ap);

  setAttrib(target, R_DimSymbol, r_dim);
  UNPROTECT(1);
}
void* user_get_array_dim(SEXP user, bool is_integer, void * previous,
                         const char *name, int rank,
                         double min, double max, int *dest_dim) {
  SEXP el = user_get_array_check_rank(user, name, rank, previous == NULL);
  if (el == R_NilValue) {
    return previous;
  }

  dest_dim[0] = LENGTH(el);
  if (rank > 1) {
    SEXP r_dim = PROTECT(coerceVector(getAttrib(el, R_DimSymbol), INTSXP));
    int *dim = INTEGER(r_dim);

    for (size_t i = 0; i < (size_t) rank; ++i) {
      dest_dim[i + 1] = dim[i];
    }

    UNPROTECT(1);
  }

  el = PROTECT(user_get_array_check(el, is_integer, name, min, max));

  int len = LENGTH(el);
  void *dest = NULL;
  if (is_integer) {
    dest = R_Calloc(len, int);
    memcpy(dest, INTEGER(el), len * sizeof(int));
  } else {
    dest = R_Calloc(len, double);
    memcpy(dest, REAL(el), len * sizeof(double));
  }
  R_Free(previous);

  UNPROTECT(1);

  return dest;
}
void* user_get_array(SEXP user, bool is_integer, void * previous,
                     const char *name, double min, double max,
                     int rank, ...) {
  SEXP el = user_get_array_check_rank(user, name, rank, previous == NULL);
  if (el == R_NilValue) {
    return previous;
  }

  SEXP r_dim;
  int *dim;

  size_t len = LENGTH(el);
  if (rank == 1) {
    r_dim = PROTECT(ScalarInteger(len));
  } else {
    r_dim = PROTECT(coerceVector(getAttrib(el, R_DimSymbol), INTSXP));
  }
  dim = INTEGER(r_dim);

  va_list ap;
  va_start(ap, rank);
  for (size_t i = 0; i < (size_t) rank; ++i) {
    int dim_expected = va_arg(ap, int);
    if (dim[i] != dim_expected) {
      va_end(ap); // avoid a leak
      if (rank == 1) {
        Rf_error("Expected length %d value for '%s'", dim_expected, name);
      } else {
        Rf_error("Incorrect size of dimension %d of '%s' (expected %d)",
                 (int)i + 1, name, dim_expected);
      }
    }
  }
  va_end(ap);
  UNPROTECT(1);

  el = PROTECT(user_get_array_check(el, is_integer, name, min, max));

  void *dest = NULL;
  if (is_integer) {
    dest = R_Calloc(len, int);
    memcpy(dest, INTEGER(el), len * sizeof(int));
  } else {
    dest = R_Calloc(len, double);
    memcpy(dest, REAL(el), len * sizeof(double));
  }
  R_Free(previous);

  UNPROTECT(1);

  return dest;
}
SEXP user_get_array_check(SEXP el, bool is_integer, const char *name,
                          double min, double max) {
  size_t len = (size_t) length(el);
  if (is_integer) {
    if (TYPEOF(el) == INTSXP) {
      user_check_values_int(INTEGER(el), len, min, max, name);
    } else if (TYPEOF(el) == REALSXP) {
      el = PROTECT(coerceVector(el, INTSXP));
      user_check_values_int(INTEGER(el), len, min, max, name);
      UNPROTECT(1);
    } else {
      Rf_error("Expected a integer value for '%s'", name);
    }
  } else {
    if (TYPEOF(el) == INTSXP) {
      el = PROTECT(coerceVector(el, REALSXP));
      user_check_values_double(REAL(el), len, min, max, name);
      UNPROTECT(1);
    } else if (TYPEOF(el) == REALSXP) {
      user_check_values_double(REAL(el), len, min, max, name);
    } else {
      Rf_error("Expected a numeric value for '%s'", name);
    }
  }
  return el;
}
SEXP user_get_array_check_rank(SEXP user, const char *name, int rank,
                               bool required) {
  SEXP el = user_list_element(user, name);
  if (el == R_NilValue) {
    if (required) {
      Rf_error("Expected a value for '%s'", name);
    }
  } else {
    if (rank == 1) {
      if (isArray(el)) {
        Rf_error("Expected a numeric vector for '%s'", name);
      }
    } else {
      SEXP r_dim = getAttrib(el, R_DimSymbol);
      if (r_dim == R_NilValue || LENGTH(r_dim) != rank) {
        if (rank == 2) {
          Rf_error("Expected a numeric matrix for '%s'", name);
        } else {
          Rf_error("Expected a numeric array of rank %d for '%s'", rank, name);
        }
      }
    }
  }
  return el;
}
void interpolate_check_y(size_t nx, size_t ny, size_t i, const char *name_arg, const char *name_target) {
  if (nx != ny) {
    if (i == 0) {
      // vector case
      Rf_error("Expected %s to have length %d (for '%s')",
               name_arg, (int)nx, name_target);
    } else {
      // array case
      Rf_error("Expected dimension %d of %s to have size %d (for '%s')",
               (int)i, name_arg, (int)nx, name_target);
    }
  }
}
double scalar_real(SEXP x, const char * name) {
  if (Rf_length(x) != 1) {
    Rf_error("Expected a scalar for '%s'", name);
  }
  double ret = 0.0;
  if (TYPEOF(x) == INTSXP) {
    ret = INTEGER(x)[0];
  } else if (TYPEOF(x) == REALSXP) {
    ret = REAL(x)[0];
  } else {
    Rf_error("Expected a numeric value for '%s'", name);
  }
  return ret;
}
// This construction is to help odin
#ifndef CINTERPOLTE_CINTERPOLATE_H_
#endif


void * cinterpolate_alloc(const char *type, size_t n, size_t ny,
                          double *x, double *y, bool fail_on_extrapolate,
                          bool auto_clean) {
  typedef void* interpolate_alloc_t(const char *, size_t, size_t,
                                    double*, double*, bool, bool);
  static interpolate_alloc_t *fun;
  if (fun == NULL) {
    fun = (interpolate_alloc_t*)
      R_GetCCallable("cinterpolate", "interpolate_alloc");
  }
  return fun(type, n, ny, x, y, fail_on_extrapolate, auto_clean);
}


int cinterpolate_eval(double x, void *obj, double *y) {
  typedef int interpolate_eval_t(double, void*, double*);
  static interpolate_eval_t *fun;
  if (fun == NULL) {
    fun = (interpolate_eval_t*)
      R_GetCCallable("cinterpolate", "interpolate_eval");
  }
  return fun(x, obj, y);
}


void cinterpolate_free(void *obj) {
  typedef int interpolate_free_t(void*);
  static interpolate_free_t *fun;
  if (fun == NULL) {
    fun = (interpolate_free_t*)
      R_GetCCallable("cinterpolate", "interpolate_free");
  }
  fun(obj);
}
